<!doctype html><html lang=en-US><head><title>集中不等式 (I)：Hoeffding 不等式</title>
<meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><meta property="og:url" content="https://gaxu.xyz/posts/conctr-ineq-hoeffding/"><meta property="og:site_name" content="嘉树的世界"><meta property="og:title" content="集中不等式 (I)：Hoeffding 不等式"><meta property="og:description" content="内容提要 介绍了集中不等式的概念，引入了 Chernoff 界方法，并以此证明了 Hoeffding 不等式。
什么是集中不等式？ Concentration inequalities，中文译作「集中不等式」，是概率论中的一类不等式，描述了一个随机变量的取值是否集中在某个特定的值附近，换句话说，相对于这个特定值偏离了多少，从概率上讲这个偏离的可能性又如何量化。这个特定的值通常取的是总体均值。数学上，这类不等式的形式可写作
$$ \mathbb{P}\{|X-\mu|>t\} \leq \text{something small} $$
这个不等式表明了，我们希望随机变量 $X$ 以很高的概率围绕在其均值附近波动。最简单、也最为我们熟悉的集中不等式当属 Chebyshev 不等式：如果 $X$ 的均值是 $\mu$，方差是 $\sigma^2$，那么
$$ \mathbb{P}\{|X-\mu|>t\} \leq \frac{\sigma^2}{t^2} $$
这个不等式当然是很一般的──我们只要求方差有限，除此之外并没有对 $X$ 的分布做更多要求。但是，在很多应用场景中，它还是太弱了，弱在不等式右边的东西不够小，或者更具体地说，当 $t\to\infty$ 时收敛到 0 的速度不够快。我们希望能有指数级别的收敛。
从渐进的观点看，当样本量足够大时，我们可以使用中心极限定理近似地得到样本均值偏离总体均值的概率，而正态分布的尾概率是指数衰减的。
Proposition 1.
若 $Z\sim\mathcal{N}(0,1)$，则对任意 $t>0$，都有
$$ \biggl(\frac1t-\frac{1}{t^3}\biggr)\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} \leq \mathbb{P}\{Z\geq t\} \leq \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} $$
Proof. 对于上界，有
$$ \begin{align*} \mathbb{P}\{Z\geq t\} &= \frac{1}{\sqrt{2\pi}}\int_t^\infty e^{-x^2/2}\,dx \\ &\leq \frac{1}{\sqrt{2\pi}}\int_t^\infty \frac{x}{t}e^{-x^2/2}\,dx \\ &= \frac{1}{t\sqrt{2\pi}} \int_t^\infty -\frac{\partial}{\partial x}e^{-x^2/2}\,dx \\ &= \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} \end{align*} $$"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-11T15:30:25+08:00"><meta property="article:modified_time" content="2024-08-21T13:24:11+08:00"><meta property="article:tag" content="高维理论"><meta name=twitter:card content="summary"><meta name=twitter:title content="集中不等式 (I)：Hoeffding 不等式"><meta name=twitter:description content="内容提要 介绍了集中不等式的概念，引入了 Chernoff 界方法，并以此证明了 Hoeffding 不等式。
什么是集中不等式？ Concentration inequalities，中文译作「集中不等式」，是概率论中的一类不等式，描述了一个随机变量的取值是否集中在某个特定的值附近，换句话说，相对于这个特定值偏离了多少，从概率上讲这个偏离的可能性又如何量化。这个特定的值通常取的是总体均值。数学上，这类不等式的形式可写作
$$ \mathbb{P}\{|X-\mu|>t\} \leq \text{something small} $$
这个不等式表明了，我们希望随机变量 $X$ 以很高的概率围绕在其均值附近波动。最简单、也最为我们熟悉的集中不等式当属 Chebyshev 不等式：如果 $X$ 的均值是 $\mu$，方差是 $\sigma^2$，那么
$$ \mathbb{P}\{|X-\mu|>t\} \leq \frac{\sigma^2}{t^2} $$
这个不等式当然是很一般的──我们只要求方差有限，除此之外并没有对 $X$ 的分布做更多要求。但是，在很多应用场景中，它还是太弱了，弱在不等式右边的东西不够小，或者更具体地说，当 $t\to\infty$ 时收敛到 0 的速度不够快。我们希望能有指数级别的收敛。
从渐进的观点看，当样本量足够大时，我们可以使用中心极限定理近似地得到样本均值偏离总体均值的概率，而正态分布的尾概率是指数衰减的。
Proposition 1.
若 $Z\sim\mathcal{N}(0,1)$，则对任意 $t>0$，都有
$$ \biggl(\frac1t-\frac{1}{t^3}\biggr)\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} \leq \mathbb{P}\{Z\geq t\} \leq \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} $$
Proof. 对于上界，有
$$ \begin{align*} \mathbb{P}\{Z\geq t\} &= \frac{1}{\sqrt{2\pi}}\int_t^\infty e^{-x^2/2}\,dx \\ &\leq \frac{1}{\sqrt{2\pi}}\int_t^\infty \frac{x}{t}e^{-x^2/2}\,dx \\ &= \frac{1}{t\sqrt{2\pi}} \int_t^\infty -\frac{\partial}{\partial x}e^{-x^2/2}\,dx \\ &= \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} \end{align*} $$"><script async src="https://www.googletagmanager.com/gtag/js?id=G-LER46KQN8K"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LER46KQN8K")}</script><script src=/js/toc.js></script><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.5c2933544a8f415fedcdfe99cbe482e02e16d05ccf7094eca66d91fd6fcb7917.css integrity="sha256-XCkzVEqPQV/tzf6Zy+SC4C4W0FzPcJTspm2R/W/LeRc=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.4a5455fe5612c2321a4b36920ca43ac63fa0b7f21ad7d11dbed36f73f5668449.css integrity="sha256-SlRV/lYSwjIaSzaSDKQ6xj+gt/Ia19EdvtNvc/VmhEk=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:500,500italic,700,700italic|Roboto:400,400italic,700,700italic|Montserrat:500,500italic,700,700italic|Fira+Mono:500,700|Noto+Serif+TC:500,700|Noto+Serif+SC:500,700|Material+Icons&display=swap"><script src=https://unpkg.com/@waline/client@v2/dist/waline.js></script><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><script>console.log("Hello from 'layouts/partials/extended_head.html'")</script><link rel=stylesheet href=/vendor/css/lxgwwenkaiscreenr.css><script defer src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/js/all.min.js></script><link rel=stylesheet href=/scss/custom/_custom.min.07270570cc4a8650f6229d55a585534fa1253613904e2c8ddf06558255549241.css integrity="sha256-BycFcMxKhlD2Ip1VpYVTT6ElNhOQTiyN3wZVglVUkkE=" media=screen><link rel=stylesheet href=/vendor/css/heti.min.css><script src=/vendor/js/heti.min.js></script><script defer>function domReady(){var e=document.querySelector(".post-subtitle");e&&e.classList.add("heti"),e=document.querySelector("#post-content"),e&&e.classList.add("heti"),document.querySelectorAll(".post-item-summary").forEach(e=>{e.classList.add("heti")})}document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),domReady()});const heti=new Heti(".heti");heti.autoSpacing(),window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],macros:{bm:["\\boldsymbol{#1}",1]},processEscapes:!0,processEnvironments:!0},svg:{scale:.962,fontCache:"global"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],enableMenu:!1}},function(){var e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,document.addEventListener("DOMContentLoaded",function(){document.head.appendChild(e)})}()</script><script>document.addEventListener("DOMContentLoaded",function(){var e,t=document.getElementsByClassName("collapsible");for(e=0;e<t.length;e++)t[e].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;e.style.display==="block"?e.style.display="none":e.style.display="block"})})</script></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item false" href=/about>关于我
</a><a class="a-block drawer-menu-item active" href=/posts>归档
</a><a class="a-block drawer-menu-item false" href=/categories>分类
</a><a class="a-block drawer-menu-item false" href=/tags>标签
</a><a class="a-block drawer-menu-item false" href=/index.xml>订阅</a><div class=toc><div class=toc-content><center>目录</center><ul><ul><li><a href=#%e5%86%85%e5%ae%b9%e6%8f%90%e8%a6%81 class=nav-内容提要>内容提要</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e9%9b%86%e4%b8%ad%e4%b8%8d%e7%ad%89%e5%bc%8f class=nav-什么是集中不等式>什么是集中不等式？</a></li><li><a href=#chernoff-%e7%95%8c%e6%96%b9%e6%b3%95 class=nav-chernoff-界方法>Chernoff 界方法</a></li><li><a href=#hoeffding-%e4%b8%8d%e7%ad%89%e5%bc%8f class=nav-hoeffding-不等式>Hoeffding 不等式</a></li><li><a href=#%e5%8f%82%e8%80%83 class=nav-参考>参考</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu
</i></button>
<a id=navTitle class=navbar-brand href=https://gaxu.xyz/>嘉树的世界
</a><button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://gaxu.xyz/><div class=single-column-header-title>嘉树的世界</div><div class=single-column-header-subtitle>靡不有初，鲜克有终</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>集中不等式 (I)：Hoeffding 不等式<div class=post-meta>嘉树 &nbsp;
<time itemprop=datePublished>2024-08-11 15:30
</time>&emsp;
<i class=material-icons>folder</i>
<a href=/categories/econometrics>Econometrics</a>
&nbsp;
<i class=material-icons>label</i>
<a href=/tags/%E9%AB%98%E7%BB%B4%E7%90%86%E8%AE%BA>高维理论</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><div id=post-content><h2 id=内容提要>内容提要&nbsp;<a class=hash-link href=#内容提要><i class="fas fa-link"></i></a></h2><p>介绍了集中不等式的概念，引入了 Chernoff 界方法，并以此证明了 Hoeffding 不等式。</p><h2 id=什么是集中不等式>什么是集中不等式？&nbsp;<a class=hash-link href=#什么是集中不等式><i class="fas fa-link"></i></a></h2><p>Concentration inequalities，中文译作「集中不等式」，是概率论中的一类不等式，描述了一个随机变量的取值是否集中在某个特定的值附近，换句话说，相对于这个特定值偏离了多少，从概率上讲这个偏离的可能性又如何量化。这个特定的值通常取的是总体均值。数学上，这类不等式的形式可写作</p><p>$$
\mathbb{P}\{|X-\mu|>t\} \leq \text{something small}
$$</p><p>这个不等式表明了，我们希望随机变量 $X$ 以很高的概率围绕在其均值附近波动。最简单、也最为我们熟悉的集中不等式当属 Chebyshev 不等式：如果 $X$ 的均值是 $\mu$，方差是 $\sigma^2$，那么</p><p>$$
\mathbb{P}\{|X-\mu|>t\} \leq \frac{\sigma^2}{t^2}
$$</p><p>这个不等式当然是很一般的──我们只要求方差有限，除此之外并没有对 $X$ 的分布做更多要求。但是，在很多应用场景中，它还是太弱了，弱在不等式右边的东西不够小，或者更具体地说，当 $t\to\infty$ 时收敛到 0 的速度不够快。我们希望能有指数级别的收敛。</p><p>从渐进的观点看，当样本量足够大时，我们可以使用中心极限定理近似地得到样本均值偏离总体均值的概率，而正态分布的尾概率是指数衰减的。</p><div class=thm><p id=prop:normal class="thm-title thm-proposition">Proposition 1.</p><div class="thm-inner thm-proposition"><p>若 $Z\sim\mathcal{N}(0,1)$，则对任意 $t>0$，都有</p><p>$$
\biggl(\frac1t-\frac{1}{t^3}\biggr)\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2} \leq \mathbb{P}\{Z\geq t\} \leq \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2}
$$</p></div></div><div class=thm><button type=button class=collapsible><div id=thm-proof-1 class=thm-title-proof>Proof.</div></button><div class=proof-content><div class=thm-inner-proof><p>对于上界，有</p><p>$$
\begin{align*}
\mathbb{P}\{Z\geq t\} &= \frac{1}{\sqrt{2\pi}}\int_t^\infty e^{-x^2/2}\,dx \\
&\leq \frac{1}{\sqrt{2\pi}}\int_t^\infty \frac{x}{t}e^{-x^2/2}\,dx \\
&= \frac{1}{t\sqrt{2\pi}} \int_t^\infty -\frac{\partial}{\partial x}e^{-x^2/2}\,dx \\
&= \frac{1}{t}\cdot\frac{1}{\sqrt{2\pi}}e^{-t^2/2}
\end{align*}
$$</p><p>对于下界，利用等式</p><p>$$
\int_t^\infty (1-3x^{-4})e^{-x^2/2}\,dx = \biggl(\frac1t-\frac1{t^3}\biggr)e^{-t^2/2}
$$</p></div><div class=thm-end-proof><i class="fas fa-square"></i> <a href=#thm-proof-1><i class="fas fa-arrow-circle-up"></i></a></div></div></div><p>不过，我们还需考虑到渐进误差的存在，也就是说，用正态分布的尾概率去近似样本均值的尾概率不是一种严格的做法。事实上，渐进误差并不必然是指数衰减的，因此我们必须从<em>非渐进</em>的角度入手，而集中不等式正是这样的角色。</p><style type=text/css>.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media(prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}</style><div><svg width="0" height="0" display="none"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379.0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628.0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628.0l-22.627 22.627c-6.248 6.248-6.248 16.379.0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937.0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154.0l239.94 416.028zM288 354c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196.0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627.0 12 5.373 12 12v1e2h12c6.627.0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice note"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#note-notice"/></svg></span>Note</p><p><a href=https://en.wikipedia.org/wiki/Berry%E2%80%93Esseen_theorem>Berry-Esseen 定理</a> 表明，中心极限定理中概率分布的收敛速率至少是 $O(1/\sqrt{n})$，不必然是指数级别的收敛。</p></div><h2 id=chernoff-界方法>Chernoff 界方法&nbsp;<a class=hash-link href=#chernoff-界方法><i class="fas fa-link"></i></a></h2><p>在开始介绍一系列集中不等式之前，我们先讲一个很具有普适性的方法：Chernoff bound，它被广泛用于各种集中不等式的证明。</p><p>利用 Markov 不等式，对 $s>0$, 我们有</p><p>$$
\mathbb{P}\{X\geq t\} = \mathbb{P}\{e^{sX}\geq e^{st}\} \leq \frac{\mathbb{E}(e^{sX})}{e^{st}}
$$</p><p>不等式右边的 $m_X(s) := \mathbb{E}(e^{sX})$ 即随机变量的矩生成函数 (moment generating function, MGF)。更使我们喜闻乐见的是，分母是一个指数函数。这意味着，只要我们能控制 MGF 不要增长的太快，我们就能保证指数级收敛。</p><p>后文的各种集中不等式反复展示了这一技巧。</p><h2 id=hoeffding-不等式>Hoeffding 不等式&nbsp;<a class=hash-link href=#hoeffding-不等式><i class="fas fa-link"></i></a></h2><p>首先介绍一个分布：对称 Bernoulli 分布，也叫 Rademacher 分布。如果随机变量 $X$ 均以 1/2 概率取值 &ndash;1 和 1，则称它服从对称 Bernoulli 分布。显然，$Z$ 服从（普通的）Berinoulli 分布当且仅当 $2Z-1$ 服从对称 Bernoulli 分布。</p><p>Hoeffding 不等式即是关于对称 Bernoulli 随机变量的。</p><div class=thm><p id=thm:hoeffding class="thm-title thm-theorem">Theorem 2 (Hoeffding’s Inequality).</p><div class="thm-inner thm-theorem"><p>设 $X_1,\dots,X_n$ 是独立的对称 Bernoulli 随机变量序列，$\bm{a}=(a_1,\dots,a_n)\in\mathbb{R}^n$ 是实值常向量。对任意 $t\geq0$，都有</p><p>$$
\mathbb{P}\Biggl\{\sum_{i=1}^n a_iX_i\geq t\Biggr\} \leq \exp\biggl(-\frac{t^2}{2\|\bm{a}\|_2^2}\biggr)
$$</p></div></div><div class=thm><button type=button class=collapsible><div id=thm-proof-2 class=thm-title-proof>Proof.</div></button><div class=proof-content><div class=thm-inner-proof><p>不失一般性，设 $\|\bm{a}\|_2 = 1$。利用 Chernoff 界方法，对 $s>0$ 有</p><p>$$
\begin{align*}
\mathbb{P}\Biggl\{\sum_{i=1}^n a_iX_i\geq t\Biggr\} &= \mathbb{P}\Biggl\{\exp\Biggl(s\sum_{i=1}^n a_iX_i\Biggr)\geq \exp(st)\Biggr\} \\
&\leq e^{-st}\mathbb{E}\Biggl[\exp\Biggl(\sum_{i=1}^n a_iX_i\Biggr)\Biggr] \\
&= e^{-st}\prod_{i=1}^n\mathbb{E}[\exp(sa_iX_i)]
\end{align*}
$$</p><p>最后一个等式使用了独立性。计算 $\mathbb{E}[\exp(sa_iX_i)]$：</p><p>$$
\mathbb{E}[\exp(sa_iX_i)] = \frac12[\exp(sa_i)+\exp(-sa_i)] = \cosh(sa_i) \leq \exp(s^2a_i^2/2)
$$</p><p>其中的不等号来自：$\cosh(x)\leq\exp(x^2/2)$ 对 $x\in\mathbb{R}$ 成立，可通过 Taylor 展开证明。于是，我们得到</p><p>$$
\begin{align*}
\mathbb{P}\Biggl\{\sum_{i=1}^n a_iX_i\geq t\Biggr\} &\leq e^{-st}\prod_{i=1}^n\mathbb{E}[\exp(sa_iX_i)] \\
&\leq e^{-st}\prod_{i=1}^n \exp(s^2a_i^2/2) \\
&= \exp\Biggl(-st+\frac{s^2}{2}\sum_{i=1}^na_i\Biggr) \\
&= \exp\biggl(-st+\frac{s^2}{2}\biggr)
\end{align*}
$$</p><p>最后一个等式利用了 $\sum_ia_i^2=1$。现在，选择最优的 $s$ 让右边的值最小，显然，这个最优的 $s=t$，这样就得到了想要的结果。</p></div><div class=thm-end-proof><i class="fas fa-square"></i> <a href=#thm-proof-2><i class="fas fa-arrow-circle-up"></i></a></div></div></div><p>我们可以轻松加愉快地得到双边版本的 Hoeffding 不等式：</p><div class=thm><p id=cor:hoeffding class="thm-title thm-corollary">Corollary 3 (Hoeffding’s Inequality, two-sided).</p><div class="thm-inner thm-corollary"><p>设 $X_1,\dots,X_n$ 是独立的对称 Bernoulli 随机变量序列，$\bm{a}=(a_1,\dots,a_n)\in\mathbb{R}^n$ 是实值常向量。对任意 $t\geq0$，都有</p><p>$$
\mathbb{P}\Biggl\{\left|\sum_{i=1}^n a_iX_i\right|\geq t\Biggr\} \leq 2\exp\biggl(-\frac{t^2}{2\|\bm{a}\|_2^2}\biggr)
$$</p></div></div><div class=thm><button type=button class=collapsible><div id=thm-proof-3 class=thm-title-proof>Proof.</div></button><div class=proof-content><div class=thm-inner-proof>对 $\sum_ia_iX_i$ 和 $-\sum_ia_iX_i$ 各应用一遍 <a href=/#thm:hoeffding>Hoeffding</a> 然后把概率相加。</div><div class=thm-end-proof><i class="fas fa-square"></i> <a href=#thm-proof-3><i class="fas fa-arrow-circle-up"></i></a></div></div></div><p>更一般地，对有界随机变量，我们也有 Hoeffding 不等式：</p><div class=thm><p id=thm:hoeffdingbounded class="thm-title thm-theorem">Theorem 4 (Hoeffding’s Inequality for Bounded Random Variables).</p><div class="thm-inner thm-theorem"><p>设 $X_1,\dots,X_n$ 是独立的随机变量序列，$\mathbb{E}(X_i) = \mu_i$ 且 $X_i\in[a_i,b_i]$。则对任意 $t\geq0$，都有</p><p>$$
\mathbb{P}\Biggl\{\sum_{i=1}^n (X_i-\mu_i)\geq t\Biggr\} \leq \exp\biggl(-\frac{2t^2}{\sum_{i=1}^n(b_i-a_i)^2}\biggr)
$$</p></div></div><div class=thm><button type=button class=collapsible><div id=thm-proof-4 class=thm-title-proof>Proof.</div></button><div class=proof-content><div class=thm-inner-proof><p>不失一般性，设 $\mu_i=0$，即所有 $X_i$ 均值为 0，这也同时意味着 $a_i\leq0\leq b_i$。</p><hr><p>我们首先证明 <a href=https://en.wikipedia.org/wiki/Hoeffding%27s_lemma>Hoeffding 引理</a>，它是说，如果有界随机变量 $X\in[a,b]$ 且均值为 0，则对 $s\in\mathbb{R}$ 恒有</p><p>$$
\mathbb{E}(e^{sX}) \leq \exp\biggl(\frac{s^2(b-a)^2}{8}\biggr)
$$</p><p>因 $e^{sx}$ 是关于 $x$ 的凸函数，故对任意 $x\in[a,b]$，我们有</p><p>$$
e^{sx} \leq \frac{b-x}{b-a}e^{sa} + \frac{x-a}{b-a}e^{sb}
$$</p><p>将 $x$ 替换为 $X$，并两边取期望，注意我们已经假设 $X$ 均值为 0，因此</p><p>$$
\begin{align*}
\mathbb{E}(e^{sX}) &\leq \frac{b-\mathbb{E}(X)}{b-a}e^{sa} + \frac{\mathbb{E}(X)-a}{b-a}e^{sb} \\
&= \frac{b}{b-a}e^{sa} + \frac{-a}{b-a}e^{sb}
\end{align*}
$$</p><p>现在，我们需要证明</p><p>$$
\frac{b}{b-a}e^{sa} + \frac{-a}{b-a}e^{sb} \leq \exp\biggl(\frac{s^2(b-a)^2}{8}\biggr)
$$</p><p>不妨进行换元 $h = s(b-a)$，上式便等价于</p><p>$$
\exp\biggl(\frac{ha}{b-a}\biggr)\biggl(\frac{b}{b-a}+\frac{-a}{b-a}e^h\biggr) \leq \exp\biggl(\frac{h^2}{8}\biggr)
$$</p><p>取对数，我们需证明</p><p>$$
f(h) := \frac{ha}{b-a} + \log\biggl(\frac{b-e^ha}{b-a}\biggr) \leq \frac{h^2}{8}
$$</p><p>将 $f(h)$ 在 $h=0$ 处 Taylor 展开：</p><p>$$
f(h) = f(0) + f&rsquo;(0)h + \frac12f&rsquo;&rsquo;(\xi)h^2 \quad\text{for some $\xi$ between 0 and $h$}
$$</p><p>注意到 $f(0) = f^\prime(0) = 0$，而对 $\xi\in\mathbb{R}$ 我们恒有</p><p>$$
f&rsquo;&rsquo;(\xi) = -\frac{e^\xi ab}{(b-e^\xi a)^2} \leq \frac14
$$</p><p>这里我们使用了均值不等式得到 $-e^\xi ab \leq \frac14(-e^\xi a+b)^2$。这就证明了 $f(h)\leq\frac18h^2$，进而证明了 Hoeffding 引理。</p><hr><p>回到定理的证明。仍然利用 Chernoff 界方法：</p><p>$$
\begin{align*}
\mathbb{P}\Biggl\{\sum_{i=1}^n X_i\geq t\Biggr\} &= \mathbb{P}\Biggl\{\exp\Biggl(s\sum_{i=1}^n X_i\Biggr)\geq \exp(st)\Biggr\} \\
&\leq e^{-st}\mathbb{E}\Biggl[\exp\Biggl(\sum_{i=1}^n X_i\Biggr)\Biggr] \\
&= e^{-st}\prod_{i=1}^n\mathbb{E}[\exp(sX_i)] \\
&\leq e^{-st}\prod_{i=1}^n\exp\biggl(\frac{s^2(b_i-a_i)^2}{8}\biggr) \\
&= \exp\biggl(-st+\frac{s^2\sum_{i=1}^n(b_i-a_i)^2}{8}\biggr) \\
&\leq \exp\biggl(-\frac{2t^2}{\sum_{i=1}^n(b_i-a_i)^2}\biggr)
\end{align*}
$$</p><p>倒数第三行调用了 Hoeffding 引理，最后一行通过取 $s=4t/\sum_{i=1}^n(b_i-a_i)^2$ 得到。</p></div><div class=thm-end-proof><i class="fas fa-square"></i> <a href=#thm-proof-4><i class="fas fa-arrow-circle-up"></i></a></div></div></div><p>（未完待续～）</p><h2 id=参考>参考&nbsp;<a class=hash-link href=#参考><i class="fas fa-link"></i></a></h2><ol><li><em>Wikipedia</em>. &ldquo;<a href=https://en.wikipedia.org/wiki/Concentration_inequality>Concentration inequality</a>.&rdquo;</li><li>Rigollet, Philippe, and Jan-Christian Hütter. 2023. &ldquo;High-Dimensional Statistics.&rdquo; <em>arXiv preprint</em>. <a href=https://arxiv.org/pdf/2310.19244.pdf>arXiv:2310.19244</a>.</li><li>Vershynin, Roman. 2018. <em>High-Dimensional Probability: An Introduction with Applications in Data Science</em>. Cambridge University Press.</li></ol></div><div><hr width=100% id=EOF style="border-top:.6px solid #777;margin-top:2.5rem"><p style=color:#777>最后修改于 2024-08-21</p></div></div></div><nav class=post-pagination><a class=older-posts href=/posts/anywhere-door/>上回<br><em>来个任意门吧</em>
</a><a class=newer-posts href=/posts/losing-concentration/>下回<br><em>专注力的流失</em></a></nav><div class=post-comment-wrapper><div id=waline></div><script>Waline.init({el:"#waline",dark:"body.night",serverURL:"https://mysitecomments-2yzw3y3tk-cwleo.vercel.app"})</script></div></div></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://gaxu.xyz/><div class=nav-title>嘉树的世界</div><div class=nav-subtitle>靡不有初，鲜克有终</div></a><div class=nav-link-list><a class="a-block nav-link-item false" href=/about>关于我
</a><a class="a-block nav-link-item active" href=/posts>归档
</a><a class="a-block nav-link-item false" href=/categories>分类
</a><a class="a-block nav-link-item false" href=/tags>标签
</a><a class="a-block nav-link-item false" href=/index.xml>订阅</a></div><div class=nav-footer>由 <a href=https://gohugo.io>Hugo</a> 强力驱动<br>主题改动自 <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a><br>&copy;
2023–2024 嘉树.
本站遵循 <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC-BY-NC 4.0</a> 协议</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper><div class=toc><div class=toc-content><center>目录</center><ul><ul><li><a href=#%e5%86%85%e5%ae%b9%e6%8f%90%e8%a6%81 class=nav-内容提要>内容提要</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e9%9b%86%e4%b8%ad%e4%b8%8d%e7%ad%89%e5%bc%8f class=nav-什么是集中不等式>什么是集中不等式？</a></li><li><a href=#chernoff-%e7%95%8c%e6%96%b9%e6%b3%95 class=nav-chernoff-界方法>Chernoff 界方法</a></li><li><a href=#hoeffding-%e4%b8%8d%e7%ad%89%e5%bc%8f class=nav-hoeffding-不等式>Hoeffding 不等式</a></li><li><a href=#%e5%8f%82%e8%80%83 class=nav-参考>参考</a></li></ul></div></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up
</i></a><a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div id=single-column-footer>由 <a href=https://gohugo.io>Hugo</a> 强力驱动<br>主题改动自 <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a><br>&copy;
2023–2024 嘉树.
本站遵循 <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC-BY-NC 4.0</a> 协议</div></div><script src=/js/journal.js></script></body></html>