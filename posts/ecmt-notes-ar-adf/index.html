<!doctype html><html lang=en-US><head><title>计量复习笔记 (VIII)：自回归估计与 (A)DF 检验</title>
<meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content="本系列之终章。"><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><meta property="og:url" content="https://cwleo.github.io/posts/ecmt-notes-ar-adf/"><meta property="og:site_name" content="嘉树的世界"><meta property="og:title" content="计量复习笔记 (VIII)：自回归估计与 (A)DF 检验"><meta property="og:description" content="本系列之终章。"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-30T12:02:47+08:00"><meta property="article:modified_time" content="2023-05-01T20:37:45+08:00"><meta property="article:tag" content="计量复习笔记"><meta property="article:tag" content="时间序列"><meta name=twitter:card content="summary"><meta name=twitter:title content="计量复习笔记 (VIII)：自回归估计与 (A)DF 检验"><meta name=twitter:description content="本系列之终章。"><script async src="https://www.googletagmanager.com/gtag/js?id=G-LER46KQN8K"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LER46KQN8K")}</script><script src=/js/toc.js></script><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/journal.min.5c2933544a8f415fedcdfe99cbe482e02e16d05ccf7094eca66d91fd6fcb7917.css integrity="sha256-XCkzVEqPQV/tzf6Zy+SC4C4W0FzPcJTspm2R/W/LeRc=" media=screen><link rel=stylesheet href=/scss/dark-mode.min.4a5455fe5612c2321a4b36920ca43ac63fa0b7f21ad7d11dbed36f73f5668449.css integrity="sha256-SlRV/lYSwjIaSzaSDKQ6xj+gt/Ia19EdvtNvc/VmhEk=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:500,500italic,700,700italic|Roboto:400,400italic,700,700italic|Montserrat:500,500italic,700,700italic|Fira+Mono:500,700|Noto+Serif+TC:500,700|Noto+Serif+SC:500,700|Material+Icons&display=swap"><script src=https://unpkg.com/@waline/client@v2/dist/waline.js></script><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><script>console.log("Hello from 'layouts/partials/extended_head.html'")</script><link rel=stylesheet href=/vendor/css/lxgwwenkaiscreenr.css><script defer src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/js/all.min.js></script><link rel=stylesheet href=/scss/custom/_custom.min.07270570cc4a8650f6229d55a585534fa1253613904e2c8ddf06558255549241.css integrity="sha256-BycFcMxKhlD2Ip1VpYVTT6ElNhOQTiyN3wZVglVUkkE=" media=screen><link rel=stylesheet href=/vendor/css/heti.min.css><script src=/vendor/js/heti.min.js></script><script defer>function domReady(){var e=document.querySelector(".post-subtitle");e&&e.classList.add("heti"),e=document.querySelector("#post-content"),e&&e.classList.add("heti"),document.querySelectorAll(".post-item-summary").forEach(e=>{e.classList.add("heti")})}document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),domReady()});const heti=new Heti(".heti");heti.autoSpacing(),window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],macros:{bm:["\\boldsymbol{#1}",1]},processEscapes:!0,processEnvironments:!0},svg:{scale:.962,fontCache:"global"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"],enableMenu:!1}},function(){var e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,document.addEventListener("DOMContentLoaded",function(){document.head.appendChild(e)})}()</script><script>document.addEventListener("DOMContentLoaded",function(){var e,t=document.getElementsByClassName("collapsible");for(e=0;e<t.length;e++)t[e].addEventListener("click",function(){this.classList.toggle("active");var e=this.nextElementSibling;e.style.display==="block"?e.style.display="none":e.style.display="block"})})</script></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item false" href=/about>关于我
</a><a class="a-block drawer-menu-item active" href=/posts>归档
</a><a class="a-block drawer-menu-item false" href=/categories>分类
</a><a class="a-block drawer-menu-item false" href=/tags>标签
</a><a class="a-block drawer-menu-item false" href=/index.xml>订阅</a><div class=toc><div class=toc-content><center>目录</center><ul><ul><li><a href=#%e5%86%85%e5%ae%b9%e6%8f%90%e8%a6%81 class=nav-内容提要>内容提要</a></li><li><a href=#ar1-%e7%9a%84%e4%bc%b0%e8%ae%a1%e5%92%8c%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-ar1-的估计和单位根检验>AR(1) 的估计和单位根检验</a></li><ul><li><a href=#dickey-fuller-%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-dickey-fuller-单位根检验>Dickey-Fuller 单位根检验</a></li><li><a href=#%e5%b8%a6%e6%88%aa%e8%b7%9d%e9%a1%b9%e5%9b%9e%e5%bd%92 class=nav-带截距项回归>带截距项回归</a></li><li><a href=#%e5%b8%a6%e6%97%b6%e9%97%b4%e8%b6%8b%e5%8a%bf%e9%a1%b9%e5%9b%9e%e5%bd%92 class=nav-带时间趋势项回归>带时间趋势项回归</a></li></ul><li><a href=#arp-%e7%9a%84%e4%bc%b0%e8%ae%a1%e5%92%8c%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-arp-的估计和单位根检验>AR(p) 的估计和单位根检验</a></li><ul><li><a href=#augmented-dickey-fuller-%e6%a3%80%e9%aa%8c class=nav-augmented-dickey-fuller-检验>Augmented Dickey-Fuller 检验</a></li></ul><li><a href=#%e5%8f%82%e8%80%83 class=nav-参考>参考</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu
</i></button>
<a id=navTitle class=navbar-brand href=https://cwleo.github.io/>嘉树的世界
</a><button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://cwleo.github.io/><div class=single-column-header-title>嘉树的世界</div><div class=single-column-header-subtitle>靡不有初，鲜克有终</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>计量复习笔记 (VIII)：自回归估计与 (A)DF 检验<div class=post-subtitle>本系列之终章。</div><div class=post-meta>嘉树 &nbsp;
<time itemprop=datePublished>2023-04-30 12:02
</time>&emsp;
<i class=material-icons>folder</i>
<a href=/categories/econometrics>Econometrics</a>
&nbsp;
<i class=material-icons>label</i>
<a href=/tags/%E8%AE%A1%E9%87%8F%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0>计量复习笔记</a>
&nbsp;
<a href=/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97>时间序列</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><div id=post-content><style type=text/css>.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media(prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}</style><div><svg width="0" height="0" display="none"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379.0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628.0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628.0l-22.627 22.627c-6.248 6.248-6.248 16.379.0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937.0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154.0l239.94 416.028zM288 354c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196.0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627.0 12 5.373 12 12v1e2h12c6.627.0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice info"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"/></svg></span>Info</p><p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) <em>Econometrics</em> 第14和16章的内容。</p></div><h2 id=内容提要>内容提要&nbsp;<a class=hash-link href=#内容提要><i class="fas fa-link"></i></a></h2><p>介绍了单位根假设下自回归系数的 OLS 估计量的渐进分布，以及由此而来的 (Augmented) Dicky-Fuller 单位根检验。</p><h2 id=ar1-的估计和单位根检验>AR(1) 的估计和单位根检验&nbsp;<a class=hash-link href=#ar1-的估计和单位根检验><i class="fas fa-link"></i></a></h2><p>设 $Y_t$ 是一个 AR(1) 过程：$Y_t = \alpha Y_{t-1} + e_t$，为简化问题<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，这里 $e_t$ 是平稳遍历的鞅差分，方差为 $\sigma_e^2$。</p><p>在平稳情形下，即 $|\alpha| &lt; 1$ 时，我们对 OLS 估计量 $\hat{\alpha}$ 以 $\sqrt{n}$ 作为 scaling，容易得到</p><p>$$
\sqrt{n}(\hat{\alpha} - \alpha) = \sqrt{n}\frac{\sum_{t=2}^nY_{t-1}e_t}{\sum_{t=2}^nY_{t-1}^2} = \frac{n^{-1/2}\sum_{t=2}^nY_{t-1}e_t}{n^{-1}\sum_{t=2}^nY_{t-1}^2} \to_d N(0,1-\alpha^2)
$$</p><p>可见，当 $\alpha \to 1$，上式将依概率收敛到 0。这也说明，$\sqrt{n}$ 放缩对于单位根是不够的。</p><p>事实上，当 $\alpha = 1$，即单位根情形下<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，应采用 $n$ 作为 scaling：</p><p>$$
n(\hat{\alpha} - 1) = \frac{n^{-1}\sum_{t=2}^nY_{t-1}e_t}{n^{-2}\sum_{t=2}^nY_{t-1}^2}
$$</p><p>分母项的收敛利用前一讲的推导方法可以得到：</p><p>$$
\begin{align*}
\frac{1}{n^2}\sum_{t=2}^nY_{t-1}^2 &= \frac1n\sum_{t=2}^n\left(\frac{Y_t}{\sqrt{n}}\right)^2 \\
&= \sum_{t=2}^n\int_{t/n}^{(t+1)/n}[Y_n(r)]^2\,dr \\
&= \int_0^1[Y_n(r)]^2\,dr + o_p(1) \\
&\to_d \int_0^1 [B(r)]^2\,dr
\end{align*}
$$</p><p>分子项的收敛涉及到随机积分。</p><div class=thm><p id=def:stochint class="thm-title thm-definition">Definition 1.</p><div class="thm-inner thm-definition"><p>随机过程 $X(r)$ 关于 $Z(r)$ 在 $[0,1]$ 上的随机积分是一个概率极限：</p><p>$$
\int_0^1X(r)\,dZ(r) := \mathop{\mathrm{plim}}\limits_{n\to\infty}\sum_{i=1}^{n-1}{\textstyle X\bigl(\frac{i}{n}\bigr)\left[Z\bigl(\frac{i+1}{n}\bigr)-Z\bigl(\frac{i}{n}\bigr)\right]}
$$</p></div></div><p>据此定义，我们有</p><p>$$
\frac1n\sum_{t=2}^nY_{t-1}e_t = \sum_{t=2}^n\frac{Y_{t-1}}{\sqrt{n}}\frac{e_t}{\sqrt{n}} = \sum_{t=2}^{n}{\textstyle Y_n\bigl(\frac{t-1}{n}\bigr)\left[Y_n\bigl(\frac{t}{n}\bigr)-Y_n\bigl(\frac{t-1}{n}\bigr)\right]} = \int_0^1 Y_n(r)\,dY_n(r)
$$</p><p>尽管 $Y_n(r)\to_d B(r)$，但这不直接意味着上式依分布收敛到 $\int_0^1 B(r)\,dB(r)$，因为随机积分不是一个连续泛函，不能使用 CMT。不过我们确实有 $\int_0^1 Y_n(r)\,dY_n(r)\to_d\int_0^1 B(r)\,dB(r)$，其严格证明比较技术化。</p><p>另一种比较取巧的方式如下（简便起见，假设 $Y_0 = 0$）：</p><p>$$
\begin{align*}
\frac1n\textstyle\sum_{t=2}^nY_{t-1}e_t &= \frac1n\textstyle\sum_{t=2}^n\left(\sum_{j=1}^{t-1}e_j\right)e_t \\
&= \frac12\left[\frac1n\left(\textstyle\sum_{j=1}^ne_j\right)^2-\frac1n\textstyle\sum_{j=1}^ne_j^2\right] \\
&\to_d \frac12[B(1)^2-\sigma_e^2] = \int_0^1B(r)\,dB(r)
\end{align*}
$$</p><p>第一个等式由于我们假设了 $Y_0 = 0$ 而成立，$Y_0$ 当然可以为任意随机变量，这于最终结果只是一个 $o_p(1)$ 的影响。第二个等式使用了分步求和，很巧妙，因而只用普通 CLT 就可得到收敛性，注意 $B(1)\sim N(0,\sigma_e^2)$。最后一个等式是 Itô 积分。</p><div class="notice note"><p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#note-notice"/></svg></span>Note</p><p>如果 $e_t$ 是弱相关序列，那么长期方差 $\gamma^2=\sigma_e^2 + 2\lambda$，$\int_0^1B(r)\,dB(r) = \frac12[B(1)^2-\gamma^2]$，最后的极限分布将是 $\int_0^1B(r)\,B(r)+\lambda$。</p></div><p>综上所述，我们得到最终结果：</p><p>$$
n(\hat{\alpha} - 1) \to_d \frac{\int_0^1B(r)\,dB(r)}{\int_0^1 [B(r)]^2\,dr} = \frac{\int_0^1W\,dW}{\int_0^1 W^2}
$$</p><p>其中 $W(r)$ 是标准布朗运动，即 $W(1)\sim N(0,1)$。注意，这里还是使用了 CMT，因为分子部分等于 $\frac12W(1)^2-\frac12$ 相当于一个常数（不考虑随机性时），而分母部分是连续泛函。</p><h3 id=dickey-fuller-单位根检验>Dickey-Fuller 单位根检验&nbsp;<a class=hash-link href=#dickey-fuller-单位根检验><i class="fas fa-link"></i></a></h3><p>DF 检验统计量和经典的 t-statistic 形式相同：</p><p>$$
\text{DF t-stat }= \frac{\hat{\alpha}-1}{\text{se}(\hat{\alpha})} = \frac{\sum y_{t-1}e_t/\sum y_{t-1}^2}{\hat{\sigma}_e\Big/\sqrt{\sum y_{t-1}^2}} = \frac{n^{-1}\sum y_{t-1}e_t}{\hat{\sigma}_e\sqrt{n^{-2}\sum y_{t-1}^2}} \to_d \frac{\int_0^1 W\,dW}{\bigl(\int_0^1 W^2\bigr)^{1/2}}
$$</p><p>可以看到，在原假设 $\alpha=1$ 下，DF 检验统计量并不服从正态分布，其分布没有解析表达式而只能通过模拟得到，是一个非对称分布。</p><h3 id=带截距项回归>带截距项回归&nbsp;<a class=hash-link href=#带截距项回归><i class="fas fa-link"></i></a></h3><p>设 $Y_t$ 是一个带截距项的单位根 $Y_t = \mu + \alpha Y_{t-1} + e_t$。根据 Frisch-Waugh-Lovell (FWL) 定理，$\hat{\alpha}$ 可由除均值序列 $Y_t^* = Y_t-\frac1n\sum_{\tau=1}^{n-1}Y_\tau$ 自回归得到，于是根据上一讲的内容，我们可以推出</p><p>$$
n(\hat{\alpha} - 1) = \frac{n^{-1}\sum_{t=2}^nY_{t-1}^{*}e_t}{n^{-2}\sum_{t=2}^n(Y_{t-1}^{*})^2} \to_d \frac{\int_0^1W^{*}\,dW}{\int_0^1 (W^{*})^2}
$$</p><p>其中 $W^*(r) = W(r) - \int_0^1W$。</p><p>对应的 DF 检验统计量在原假设下的极限具有和无截距项时相似的表达式。</p><h3 id=带时间趋势项回归>带时间趋势项回归&nbsp;<a class=hash-link href=#带时间趋势项回归><i class="fas fa-link"></i></a></h3><p>设 $Y_t = \mu + \beta t + \alpha Y_{t-1} + e_t$。依然由 FWL 定理，$\hat{\alpha}$ 可由除趋势序列 $Y_t^{**}$ 自回归得到，因此</p><p>$$
n(\hat{\alpha} - 1) = \frac{n^{-1}\sum_{t=2}^nY_{t-1}^{**}e_t}{n^{-2}\sum_{t=2}^n(Y_{t-1}^{**})^2} \to_d \frac{\int_0^1W^{**}\,dW}{\int_0^1 (W^{**})^2}
$$</p><p>其中 $W^{**} = W - \bm{X}'\bigl(\int_0^1\bm{X}\bm{X}'\bigr)^{-1}\int_0^1\bm{X}W$。</p><h2 id=arp-的估计和单位根检验>AR(p) 的估计和单位根检验&nbsp;<a class=hash-link href=#arp-的估计和单位根检验><i class="fas fa-link"></i></a></h2><p>假设 $Y_t$ 是一个 AR($p$) 过程：$a(L)Y_t=e_t$，$e_t$ 仍为一个平稳遍历的鞅差分，方差 $\sigma_e^2$；$a(z)$ 是一个可逆的 $p$ 阶多项式。</p><p>假设 $a(z)$ 有一个单位根，换言之，$a(z) = (1-z)\tilde{a}(z)$，$\tilde{a}(z)$ 是一个可逆 $p-1$ 阶多项式。这意味着</p><p>$$
\tilde{a}(L)\Delta Y_t = e_t \Rightarrow Y_t = Y_{t-1} + \tilde{b}(L)e_t
$$</p><p>即 $Y_t$ 本身就是一个随机游走。我们可通过 Beveridge-Nelson 分解得到其均值和趋势的极限分布，但现在我们关心的是估计和检验的问题。</p><p>首先注意到 $Y_t$ 可以写成</p><p>$$
Y_t = a_1Y_{t-1} + \dots + a_pY_{t-p} + e_t
$$</p><p>其中必有 $a_1+\dots+a_p = 1$，因为单位根的存在。或者表述成更紧凑的形式</p><p>$$
Y_t = \bm{a}'\bm{W}_{t-1} + e_t \quad\text{where }\bm{a} = (a_1,\dots,a_p)', \bm{W}_{t-1} = (Y_{t-1},\dots,Y_{t-p})'
$$</p><p>然后，我们使用矩阵做一点小小的变换：</p><p>$$
Y_t = (\bm{B}\bm{a})&rsquo;(\bm{B}')^{-1}\bm{W}_{t-1} + e_t = (\rho,\bm{\beta}')(Y_{t-1},\bm{X}'_{t-1})' + e_t
$$</p><p>其中变换矩阵 $\bm{B}$ 和其逆矩阵的转置（取 $p=3$）形如</p><p>$$
\bm{B} =
\begin{pmatrix}
1 & 1 & 1 \\
0 & -1 & -1 \\
0 & 0 & -1
\end{pmatrix}\quad
(\bm{B}')^{-1} =
\begin{pmatrix}
1 & 0 & 0 \\
1 & -1 & 0 \\
0 & 1 & -1
\end{pmatrix}
$$</p><p>因此 $\rho = a_1+\dots+a_p=1$，$\bm{X}_{t-1} = (\Delta Y_{t-1},\dots,\Delta Y_{t-p+1})$。我们实际上在将 $Y_t$ 写为</p><p>$$
Y_t = \rho Y_{t-1} + \beta_1\Delta Y_{t-1} + \dots + \beta_{p-1}\Delta Y_{t-p+1} + e_t
$$</p><p>这方便我们做回归并直接检验 $\rho = 1$ 而不必做联合检验。这种手法在初级计量接触过。此外，上述变换将回归元分为单位根部分 $Y_{t-1}$ 和平稳部分 $\bm{X}_{t-1}$。</p><p>于是，我们为 $\hat{\rho}$ 和 $\hat{\bm{\beta}}$ 选择不同的 scaling：</p><p>$$
\begin{pmatrix}
n(\hat{\rho}-1) \\ \sqrt{n}(\hat{\bm{\beta}}-\bm{\beta})
\end{pmatrix} =
\begin{bmatrix}
\displaystyle
\frac{1}{n^2}\sum_{t=1+p}^nY_{t-1}^2 & \displaystyle\frac{1}{n^{3/2}}\sum_{t=1+p}^nY_{t-1}\bm{X}_{t-1}' \\
\displaystyle\frac{1}{n^{3/2}}\sum_{t=1+p}^n\bm{X}_{t-1}Y_{t-1} & \displaystyle\frac{1}{n}\sum_{t=1+p}^n\bm{X}_{t-1}\bm{X}_{t-1}'
\end{bmatrix}^{-1}
\begin{bmatrix}
\displaystyle
\frac1n\sum_{t=1+p}^nY_{t-1}e_t \\
\displaystyle
\frac1{\sqrt{n}}\sum_{t=1+p}^n\bm{X}_{t-1}e_t
\end{bmatrix}
$$</p><p>我们依次对各项进行分析。首先根据 Beveridge-Nelson 分解我们知道 $Y_n(r)\to_d B(r)$，单位时间方差 $\sigma_y^2=\sigma_e^2/a(1)^2$，因此</p><p>$$
\frac{1}{n^2}\sum_{t=1+p}^nY_{t-1}^2 \to_d \frac{\sigma_e^2}{a(1)^2}\int_0^1W^2
$$</p><p>交叉项是一个 $p-1$ 维向量，我们分析其中一个分量，例如第一个分量</p><p>$$
\frac{1}{n^{3/2}}\sum_{t=1+p}^nY_{t-1}\Delta Y_{t-1} = \frac{1}{\sqrt{n}}\frac1n\sum_{t=1+p}^n(Y_{t-1}^2-Y_{t-1}Y_{t-2}) = \frac{1}{\sqrt{n}} O_p(1) = o_p(1)
$$</p><p>类似可证明其他分量也是 $o_p(1)$。</p><p>$\bm{X}_{t-1}$ 是平稳遍历的，因此遍历定理表明 $n^{-1}\sum\bm{X}_{t-1}\bm{X}_{t-1}'\to_p\bm{Q}=\mathbb{E}(\bm{X}\bm{X}')$。此外，$\bm{X}_{t-1}e_t$ 是平稳弱相关的（但不再是鞅差分，因而无法使用鞅差分 CLT），采用对应的 CLT（课本定理 14.15），我们有</p><p>$$
\frac1{\sqrt{n}}\sum_{t=1+p}^n\bm{X}_{t-1}e_t \to_d N(\bm{0},\bm{\Omega}) \quad\text{where } \bm{\Omega}=\mathbb{E}(\bm{X}_{t-1}\bm{X}_{t-1}'e_t^2)
$$</p><p>最后，$\frac1n\sum_{t=1+p}^nY_{t-1}e_t$ 的极限分布</p><p>$$
\frac1n\sum_{t=1+p}^nY_{t-1}e_t \to_d \int_0^1B_y(r)\,B_e(r) = \sigma_y\sigma_e\int_0^1W\,dW
$$</p><p>注意 $B_y$ 和 $B_e$ 是完全相关的两个布朗运动，它们标准化后是同一个标准布朗运动。</p><p>综合以上分析，我们有</p><p>$$
\begin{pmatrix}
n(\hat{\rho}-1) \\ \sqrt{n}(\hat{\bm{\beta}}-\bm{\beta})
\end{pmatrix}\to_d
\begin{pmatrix}
\sigma_y^2\int_0^1W^2 & 0 \\ 0 & \bm{Q}
\end{pmatrix}^{-1}
\begin{pmatrix}
\sigma_y\sigma_e\int_0^1W\,dW \\ N(\bm{0},\bm{\Omega})
\end{pmatrix} =
\begin{pmatrix}
a(1)\frac{\int_0^1W\,dW}{\int_0^1W^2} \\ N(\bm{0},\bm{Q}^{-1}\bm{\Omega}\bm{Q}^{-1})
\end{pmatrix}
$$</p><p>可见，在渐进分布中，平稳部分和非平稳部分是不相干的。</p><p>若要恢复对原模型的估计，只需要做逆变换 $\bm{a} = \bm{B}^{-1}(\rho,\bm{\beta}')'$，我们有</p><p>$$
\sqrt{n}(\hat{\bm{a}}-\bm{a}) = \sqrt{n}\bm{B}^{-1}
\begin{pmatrix}
n^{-1} & 0 \\ 0 & n^{-1/2}
\end{pmatrix}
\begin{pmatrix}
n(\hat{\rho}-1) \\ \sqrt{n}(\hat{\bm{\beta}}-\bm{\beta})
\end{pmatrix}\to_d
\bm{B}^{-1}
\begin{pmatrix}
o_p(1) \\ N(\bm{0},\bm{Q}^{-1}\bm{\Omega}\bm{Q}^{-1})
\end{pmatrix}
$$</p><p>令 $\bm{G} = \bm{B}^{-1}(:,2:p)$，则</p><p>$$
\sqrt{n}(\hat{\bm{a}}-\bm{a}) \to_d N(\bm{0},\bm{G}\bm{Q}^{-1}\bm{\Omega}\bm{Q}^{-1}\bm{G}')
$$</p><p>可见单位根的存在完全不影响对原 AR 模型的估计和检验，我们可以假装看不见而采用经典的估计和检验方法。这本质上是因为单位根部分以 $O_p(n^{-1})$ 的速率收敛，在寻常的 $\sqrt{n}$ 缩放下依然是收敛的。</p><h3 id=augmented-dickey-fuller-检验>Augmented Dickey-Fuller 检验&nbsp;<a class=hash-link href=#augmented-dickey-fuller-检验><i class="fas fa-link"></i></a></h3><p>依照上述推导，ADF 检验 $H_0\colon\rho=1$ vs. $H_1\colon\rho&lt;1$，检验统计量及分布：</p><p>$$
\text{ADF t-stat }= \frac{\hat{\rho}-1}{\text{se}(\hat{\rho})} = \to_d \frac{\int_0^1 W\,dW}{\bigl(\int_0^1 W^2\bigr)^{1/2}}
$$</p><p>此外，还有带截距项、带趋势项回归的检验，统计量和分布可比照 AR(1) 情形。</p><h2 id=参考>参考&nbsp;<a class=hash-link href=#参考><i class="fas fa-link"></i></a></h2><p>Hansen, Bruce (2022). <em>Econometrics</em>. Princeton University Press.</p><p>Phillips, Peter C.B. (1987). &ldquo;Time Series Regression with a Unit Root.&rdquo; <em>Econometrica</em>, 55(2), 277-301.</p><p>Phillips, Peter C.B. and Xiao, Zhijie (1998). &ldquo;A Primer on Unit Root Testing.&rdquo; <em>Journal of Economic Surveys</em>, 12(5), 423-470.</p><p>Xiao, Zhijie (2014). &ldquo;Unit Roots: A Selective Review of the Contributions of Peter C.B. Phillips.&rdquo; <em>Econometric Theory</em>, 30(4), 775-814.</p><br><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>$e_t$ 可以是平稳弱相关序列，这会导致后文极限分布表达式中包含 $e_t$ 的长期协方差，例如，见 Xiao (2014) 或文中 Note。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>对于 $\alpha = -1$，我们有 $Y_t = Y_{t-2} + \Delta e_t$，令 $X_{t-j} = Y_{t-2j}$，则 $X_t$ 是一个随机游走。因此分析 $\alpha = 1$ 不失一般性。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div><hr width=100% id=EOF style="border-top:.6px solid #777;margin-top:2.5rem"><p style=color:#777>最后修改于 2023-05-01</p></div></div></div><nav class=post-pagination><a class=older-posts href=/posts/ecmt-notes-fclt-means-trends/>上回<br><em>计量复习笔记 (VII)：单位根序列的均值和趋势</em>
</a><a class=newer-posts href=/posts/micro-qe-preparation/>下回<br><em>Micro QE 备考练习</em></a></nav><div class=post-comment-wrapper><div id=waline></div><script>Waline.init({el:"#waline",dark:"body.night",serverURL:"https://mysitecomments-2yzw3y3tk-cwleo.vercel.app"})</script></div></div></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://cwleo.github.io/><div class=nav-title>嘉树的世界</div><div class=nav-subtitle>靡不有初，鲜克有终</div></a><div class=nav-link-list><a class="a-block nav-link-item false" href=/about>关于我
</a><a class="a-block nav-link-item active" href=/posts>归档
</a><a class="a-block nav-link-item false" href=/categories>分类
</a><a class="a-block nav-link-item false" href=/tags>标签
</a><a class="a-block nav-link-item false" href=/index.xml>订阅</a></div><div class=nav-footer>由 <a href=https://gohugo.io>Hugo</a> 强力驱动<br>主题改动自 <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a><br>&copy;
2023–2024 嘉树.
本站遵循 <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC-BY-NC 4.0</a> 协议</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper><div class=toc><div class=toc-content><center>目录</center><ul><ul><li><a href=#%e5%86%85%e5%ae%b9%e6%8f%90%e8%a6%81 class=nav-内容提要>内容提要</a></li><li><a href=#ar1-%e7%9a%84%e4%bc%b0%e8%ae%a1%e5%92%8c%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-ar1-的估计和单位根检验>AR(1) 的估计和单位根检验</a></li><ul><li><a href=#dickey-fuller-%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-dickey-fuller-单位根检验>Dickey-Fuller 单位根检验</a></li><li><a href=#%e5%b8%a6%e6%88%aa%e8%b7%9d%e9%a1%b9%e5%9b%9e%e5%bd%92 class=nav-带截距项回归>带截距项回归</a></li><li><a href=#%e5%b8%a6%e6%97%b6%e9%97%b4%e8%b6%8b%e5%8a%bf%e9%a1%b9%e5%9b%9e%e5%bd%92 class=nav-带时间趋势项回归>带时间趋势项回归</a></li></ul><li><a href=#arp-%e7%9a%84%e4%bc%b0%e8%ae%a1%e5%92%8c%e5%8d%95%e4%bd%8d%e6%a0%b9%e6%a3%80%e9%aa%8c class=nav-arp-的估计和单位根检验>AR(p) 的估计和单位根检验</a></li><ul><li><a href=#augmented-dickey-fuller-%e6%a3%80%e9%aa%8c class=nav-augmented-dickey-fuller-检验>Augmented Dickey-Fuller 检验</a></li></ul><li><a href=#%e5%8f%82%e8%80%83 class=nav-参考>参考</a></li></ul></div></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up
</i></a><a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div id=single-column-footer>由 <a href=https://gohugo.io>Hugo</a> 强力驱动<br>主题改动自 <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a><br>&copy;
2023–2024 嘉树.
本站遵循 <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC-BY-NC 4.0</a> 协议</div></div><script src=/js/journal.js></script></body></html>