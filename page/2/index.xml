<?xml-stylesheet href="/rss.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>嘉树的世界</title><link>https://gaxu.xyz/</link><description>Recent content on 嘉树的世界</description><generator>Hugo -- gohugo.io</generator><language>zh</language><copyright>2023–2024 嘉树.</copyright><lastBuildDate>Tue, 27 Aug 2024 19:29:37 +0800</lastBuildDate><atom:link href="https://gaxu.xyz/index.xml" rel="self" type="application/rss+xml"/><item><title>计量复习笔记 (VII)：单位根序列的均值和趋势</title><link>https://gaxu.xyz/posts/ecmt-notes-fclt-means-trends/</link><pubDate>Sat, 29 Apr 2023 13:28:11 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-fclt-means-trends/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-fclt-means-trends/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>介绍了随机游走序列的样本均值、带趋势项回归、除均值和除趋势等过程的渐进分布，它们都涉及布朗运动。&lt;/p>
&lt;h2 id="样本均值过程">样本均值过程&lt;/h2>
&lt;p>设 $Y_t = \sum_{\tau=1}^te_\tau$ 是上一讲定义的部分和序列，阶跃函数 $Y_n(r)$ 的具体定义如下：&lt;/p>
&lt;p>$$
Y_n(r) = \frac{1}{\sqrt{n}}Y_{\lfloor nr\rfloor} = \frac{1}{\sqrt{n}}Y_t \quad \text{for } \textstyle r\in\left[\frac{t}{n},\frac{t+1}{n}\right) \quad t = 1,\dots,n
$$&lt;/p>
&lt;p>也就是说，$Y_n(r)$ 在区间 $\left[\frac{t}{n},\frac{t+1}{n}\right)$ 上是常数（当然是对固定的 $\omega$），因此可写为&lt;/p>
&lt;p>$$
\frac{1}{\sqrt{n}}Y_t = n\cdot\frac1n Y_n(r) = n\int_{t/n}^{(t+1)/n} Y_n(r)\,dr
$$&lt;/p>
&lt;p>于是，对样本均值 $\bar{Y}_n = n^{-1}\sum_{t=1}^nY_t$，我们有&lt;/p>
&lt;p>$$
\begin{align*}
\frac{1}{\sqrt{n}}\bar{Y}_n &amp;amp;= \sum_{t=1}^n\int_{t/n}^{(t+1)/n} Y_n(r)\,dr = \int_{1/n}^{1+1/n} Y_n(r)\,dr \\
&amp;amp;= \int_0^1Y_n(r)\,dr + \frac{1}{n^{3/2}}Y_n - \frac{1}{n^{3/2}}Y_0 \\
&amp;amp;= \int_0^1Y_n(r)\,dr + o_p(1)
\end{align*}
$$&lt;/p>
&lt;p>这个式子刻画了（标准化的）样本均值同（几乎处处连续的）阶跃函数的关系：阶跃函数是一个连续时间随机过程，它关于时间的积分就成了一个随机变量，我们就是在将样本均值表述成一个连续时间随机过程对时间的积分。&lt;/p>
&lt;p>我们从上一讲已经知道 $Y_n(r)\to_d B(r)$。积分作为一个泛函，是关于被积函数的一个连续函数，因而根据 &lt;em>连续映射定理 (Continuous Mapping Theorem, CMT)&lt;/em>，有&lt;/p>
&lt;p>$$
\frac{1}{\sqrt{n}}\bar{Y}_n = \int_0^1 Y_n(r)\,dr + o_p(1) \to_d \int_0^1 B(r)\,dr
$$&lt;/p>
&lt;p>即 scaled 样本均值依分布收敛于布朗运动在时间维度上的平均。这也表明了 $\bar{Y}_n$ 本身是发散的，即一个单位根序列不具有均值回归的性质。&lt;/p>
&lt;h2 id="带趋势项回归">带趋势项回归&lt;/h2>
&lt;p>用单位根序列对时间趋势回归会得到不同寻常的结果。我们采用 &lt;a href="https://gaxu.xyz/posts/ecmt-notes-time-trends/">第四讲&lt;/a> 中的 scaling 矩阵 $\bm{D}_n = \text{diag}\{\sqrt{n},n^{3/2}\}$，分母的收敛仍然是&lt;/p>
&lt;p>$$
\bm{D}_n^{-1}\bm{X}'\bm{X}\bm{D}_n^{-1} \to
\begin{pmatrix}
1 &amp;amp; \frac12 \\ \frac12 &amp;amp; \frac13
\end{pmatrix}
$$&lt;/p>
&lt;p>分子项 $\bm{D}_n^{-1}\sum_{t=1}^n\bm{X}_tY_{t}$ 的两个分量可以表述如下：&lt;/p>
&lt;p>$$
\begin{align*}
\frac{1}{\sqrt{n}}\sum_{t=1}^n Y_t &amp;amp;= n\cdot\frac{1}{\sqrt{n}}\bar{Y}_n \\
\frac{1}{n^{3/2}}\sum_{t=1}^n tY_t &amp;amp;= n\sum_{t=1}^n\int_{t/n}^{(t+1)/n} X_n(r)Y_n(r)\,dr = n\left[\int_0^1 X_n(r)Y_n(r)\,dr + o_p(1)\right]
\end{align*}
$$&lt;/p>
&lt;p>其中 $X_n(r)$ 的定义与 $Y_n(r)$ 类似：&lt;/p>
&lt;p>$$
X_n(r) = \frac{1}{n}X_{\lfloor nr\rfloor} = \frac{1}{n}t \quad \text{for } \textstyle r\in\left[\frac{t}{n},\frac{t+1}{n}\right) \quad t = 1,\dots,n
$$&lt;/p>
&lt;p>显然，$\sup_r|X_n(r)-r|=1/n\to0$，因而由 CMT 得到 $X_n(r)Y_n(r)\to_d rB(r)$，再次使用 CMT 便有&lt;/p>
&lt;p>$$
\int_0^1 X_n(r)Y_n(r)\,dr \to_d \int_0^1 rB(r)\,dr
$$&lt;/p>
&lt;p>以上分析表明，$\bm{D}_n^{-1}$ 还不足以使分子项收敛，还需除以 $n$，即有&lt;/p>
&lt;p>$$
\frac{1}{n}\bm{D}_n^{-1}\sum_{t=1}^n\bm{X}_tY_{t} \to_d
\begin{pmatrix}
\int_0^1 B(r)\,dr \\ \int_0^1 rB(r)\,dr
\end{pmatrix}
$$&lt;/p>
&lt;p>综合起来就是&lt;/p>
&lt;p>$$
\frac1n\bm{D}_n\hat{\bm{\beta}} =
\begin{pmatrix}
n^{-1/2}\hat{\beta}_0 \\ \sqrt{n}\hat{\beta}_1
\end{pmatrix}
\to_d
\begin{pmatrix}
1 &amp;amp; \frac12 \\ \frac12 &amp;amp; \frac13
\end{pmatrix}^{-1}
\begin{pmatrix}
\int_0^1 B(r)\,dr \\ \int_0^1 rB(r)\,dr
\end{pmatrix}
$$&lt;/p>
&lt;p>这表明，$\hat{\beta}_1$ 具有与平稳情形下 OLS 估计量相同的收敛速度，只是收敛到 0。如果我们不知道一个序列是单位根而做了带趋势项回归，那么拟合出的趋势线的斜率是具有误导性的，因为它不应该传达任何有价值的信息，对预测也毫无帮助。&lt;/p>
&lt;h2 id="除均值和除趋势">除均值和除趋势&lt;/h2>
&lt;p>考虑除均值序列 $Y_t^* = Y_t - \bar{Y}_n$，对其构造阶跃并除以 $\sqrt{n}$，得到&lt;/p>
&lt;p>$$
Y_n^{*}(r) = \frac{1}{\sqrt{n}}Y_{\lfloor nr\rfloor}^* = Y_n(r) - \frac{1}{\sqrt{n}}\bar{Y}_n \to_d B(r) - \int_0^1 B(s)\,ds
$$&lt;/p>
&lt;p>注意，我们仍应用了 CMT，这里的映射 $T(f) = f - \int_0^1 f$ 是一个泛函，它将 $C[0,1]$ 中的函数映射回 $C[0,1]$。&lt;/p>
&lt;p>线性除趋势序列 $Y_t^{**} = Y_t - \bm{X}_t'\hat{\bm{\beta}}$，对应的阶跃函数&lt;/p>
&lt;p>$$
\begin{align*}
Y_n^{**}(r) &amp;amp;= \frac{1}{\sqrt{n}}Y_{\lfloor nr\rfloor}^{**} = Y_n(r) - \frac{1}{\sqrt{n}}\hat{\beta}_0 - \frac{\lfloor nr\rfloor}{n}\sqrt{n}\hat{\beta}_1 \\
&amp;amp;\to_d B(r) - \bm{X}(r)'\begin{pmatrix}
1 &amp;amp; \frac12 \\ \frac12 &amp;amp; \frac13
\end{pmatrix}^{-1}\int_0^1\bm{X}(s)B(s)\,ds
\end{align*}
$$&lt;/p>
&lt;p>其中 $\bm{X}(r) = (1,r)'$。&lt;/p>
&lt;p>线性插值除趋势：$\widetilde{Y}_t = Y_t - Y_0 - \frac{t}{n}(Y_n-Y_0)$，这不是通过拟合，而是连接 $Y_0$ 和 $Y_n$ 得到的趋势线。对应的阶跃函数&lt;/p>
&lt;p>$$
\begin{align*}
\widetilde{Y}_n(r) &amp;amp;= \frac{1}{\sqrt{n}}\widetilde{Y}_{\lfloor nr\rfloor} = Y_n(r) - \frac{1}{\sqrt{n}}Y_0 - \frac{\lfloor nr\rfloor}{n^{3/2}}(Y_n-Y_0) \\
&amp;amp;= Y_n(r) - \frac{\lfloor nr\rfloor}{n}\frac{1}{\sqrt{n}}Y_n + o_p(1) \\
&amp;amp;\to_d B(r) - rB(1)
\end{align*}
$$&lt;/p>
&lt;p>极限过程 $V(r) := B(r) - rB(1)$ 称作 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Brownian_bridge">布朗桥 (Brownian Bridge)&lt;/a>&lt;/em>，其特点是每条样本路径首末值均为 0，就像一座桥一样连接 $r=0$ 和 $r=1$ 两个端点。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-fclt-means-trends/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (VI)：Beveridge-Nelson 分解</title><link>https://gaxu.xyz/posts/ecmt-notes-bndecomp/</link><pubDate>Fri, 28 Apr 2023 23:42:25 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-bndecomp/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-bndecomp/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>介绍了 Beveridge-Nelson 分解，并通过此法证明了更一般的平稳序列（允许序列相关）的部分和过程的极限分布。&lt;/p>
&lt;h2 id="beveridge-nelson-分解">Beveridge-Nelson 分解&lt;/h2>
&lt;p>在上一讲的例子中，$e_t$ 是一个平稳遍历的鞅差分，这是一个比较特殊的平稳序列，现在我们想知道对于更一般的平稳序列，其（标准化的）部分和过程 $S_n(r)$ 是否也能通过 FCLT 得到一个极限分布。&lt;/p>
&lt;p>我们考虑 $e_t$ 是一个 $\text{MA}(\infty)$ 的情况，它仍然是平稳的，只是允许了序列相关。具体而言，设&lt;/p>
&lt;p>$$
e_t = \Theta(L)u_t = \sum_{j=0}^\infty\theta_ju_{t-j}
$$&lt;/p>
&lt;p>其中 $u_t$ 是一个平稳遍历的鞅差分，方差为 $\sigma^2$。&lt;/p>
&lt;p>Beveridge-Nelson 分解依赖于对多项式 $\Theta(z)$ 的分解：&lt;/p>
&lt;p>$$
\begin{align*}
\Theta(z) &amp;amp;= \Theta(1) + [\Theta(z)-\Theta(1)] \\
&amp;amp;= \textstyle\Theta(1) + \left(\sum_{j=0}^\infty\theta_jz^j-\sum_{j=0}^\infty\theta_j\right) \\
&amp;amp;= \textstyle\Theta(1) + (1-z)\sum_{j=0}^\infty\left(-\theta_j\sum_{k=0}^{j-1}z^k\right) \\
&amp;amp;= \textstyle\Theta(1) + (1-z)\sum_{k=0}^\infty\left(-\sum_{j=k+1}^\infty\theta_j\right)z^k \\
&amp;amp;= \textstyle\Theta(1) + (1-z)\sum_{k=0}^\infty\theta_k^* z^k \\
&amp;amp;= \Theta(1) + (1-z)\Theta^{*}(z)
\end{align*}
$$&lt;/p>
&lt;p>为保证求和顺序可交换，一个充分条件是 $\sum_{k=0}^\infty|\theta^*_k|&amp;lt;\infty$。&lt;/p>
&lt;p>于是，$e_t$ 可分解为&lt;/p>
&lt;p>$$
e_t = \Theta(1)u_t + (1-L)[\Theta^{*}(L)u_t] \equiv \xi_t + \nu_t-\nu_{t-1}
$$&lt;/p>
&lt;p>$\xi_t$ 无疑仍是一个平稳遍历的鞅差分，方差为 $\Theta(1)^2\sigma^2$；根据第二和第三讲，$\nu_t=\Theta^{*}(L)u_t$ 也是平稳遍历的（但不再是鞅差分）。&lt;/p>
&lt;p>那么，部分和序列就有如下分解&lt;/p>
&lt;p>$$
Y_t = \sum_{\tau=1}^te_\tau = \sum_{\tau=1}^t\xi_\tau + \nu_t - \nu_0
$$&lt;/p>
&lt;p>求和项 $\sum\xi_\tau$ 称为 &lt;em>永久部分 (permenant component)&lt;/em> 或趋势部分，随时间而积累；$\nu_t-\nu_0$ 称为 &lt;em>瞬时部分 (transitory component)&lt;/em>，不随时间积累；前者是 $Y_t$ 在长期的决定部分。此分解就是 Beveridge-Nelson 分解。&lt;/p>
&lt;h2 id="部分和过程的极限分布">部分和过程的极限分布&lt;/h2>
&lt;p>通过构造阶跃并除以 $\sqrt{n}$，得到标准化的连续时间部分和过程&lt;/p>
&lt;p>$$
Y_n(r) = \frac{1}{\sqrt{n}}Y_{\lfloor nr\rfloor} = \frac{1}{\sqrt{n}}\sum_{\tau=1}^{\lfloor nr\rfloor}\xi_\tau + \frac{1}{\sqrt{n}}\nu_{\lfloor nr\rfloor} - \frac{1}{\sqrt{n}}\nu_0
$$&lt;/p>
&lt;p>第一项应用上一讲的内容，依分布收敛到布朗运动 $B(r)$，单位时间累积方差为 $\Theta(1)^2\sigma^2$；第三项显然是 $o_p(1)$，因为任意随机变量都是 $O_p(1)$。&lt;/p>
&lt;p>第二项值得细说。它是 $o_p(1)$ 的一个充分条件是 $\max_{1\leq t\leq n}n^{-1/2}|\nu_t| = o_p(1)$，这是因为&lt;/p>
&lt;p>$$
|\nu_{\lfloor nr\rfloor}| \leq \max_{1\leq t\leq n}|\nu_t| \quad\text{for every } r\in[0,1]
$$&lt;/p>
&lt;p>而 $\max_{1\leq t\leq n}n^{-1/2}|\nu_t| = o_p(1)$ 的一个充分条件是平稳序列 $\nu_t$ 方差有限，这一点是满足的：&lt;/p>
&lt;p>$$
\text{var}(\nu_t) = \sigma^2\sum_{j=0}^\infty(\theta^{*}_j)^2 &amp;lt; \infty
$$&lt;/p>
&lt;p>注意，$\sum_{j=0}^\infty|\theta^{*}_j|$ 收敛必然意味着 $\sum_{j=0}^\infty(\theta^{*}_j)^2$ 收敛。因此，第二项也是 $o_p(1)$。&lt;/p>
&lt;p>以上分析表明了，$Y_n(r) \to_d B(r)$，单位时间方差 $\Theta(1)^2\sigma^2$。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-bndecomp/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (V)：泛函中心极限定理</title><link>https://gaxu.xyz/posts/ecmt-notes-fclt/</link><pubDate>Thu, 27 Apr 2023 20:46:10 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-fclt/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-fclt/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>介绍了泛函中心极限定理，并用其证明了鞅差分部分和过程的极限分布。&lt;/p>
&lt;h2 id="泛函中心极限定理">泛函中心极限定理&lt;/h2>
&lt;p>一个随机过程 $\{e_t(\omega)\}_{t=1}^n$，当我们固定 $\omega$ 时（即一次 realization），我们就得到了一条样本路径，关于时间的函数。我们可以像在绘制折线图那样，将离散点连接起来，就得到了一条 $[1,n]$ 上连续的曲线；当然，也可以像后文那样，在离散点之间用水平线插值，得到一个阶跃函数，只在有限个点处不连续，这不会影响核心性质。不失一般性，我们总可以将区间 $[1,n]$ 对应到 $[0,1]$ 上，也就是说，将一个 $[1,n]$ 上的函数水平伸缩到 $[0,1]$ 上，这不难做到。最后，我们将得到一个 $C[0,1]$ 中的函数，$C[0,1]$ 是全体 $[0,1]$ 上（几乎处处）连续的实值函数构成的函数空间&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>。&lt;/p>
&lt;p>以上的操作事实上建立了从 $\mathbb{R}^{n}$ 中的点（因为 $e_1(\omega),\dots,e_n(\omega)$ 是 $n$ 个实数值）到 $C[0,1]$ 中的函数的映射，在这个映射下会有一个像测度，它描述了 $C[0,1]$ 上随机函数的分布，或者说连续时间随机过程的分布。泛函中心极限定理关心的问题就是，当 $n\to\infty$ 时，这个分布的收敛情况。&lt;/p>
&lt;p>一个典型的 $C[0,1]$ 上的概率测度是 Wiener 测度，它是 Wiener 过程（又称 Brownian motion）的分布。&lt;/p>
&lt;p>以下我们直接给出泛函中心极限定理 (Functional Central Limit Theorem, FCLT)：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:fclt" class="thm-title thm-Theorem">Theorem 1.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>对随机过程 $\{e_t(\omega)\}_{t=1}^\infty$，记 $S_t = \sum_{\tau=1}^te_{\tau}$ 为部分和序列，构造一个阶跃函数 $S_n(\cdot)\colon[0,1]\to\mathbb{R}$：&lt;/p>
&lt;p>$$
S_n(r) = \frac{1}{\sqrt{n}} S_{\lfloor nr\rfloor} = \frac{1}{\sqrt{n}}\sum_{t=1}^{\lfloor nr\rfloor}e_t
$$&lt;/p>
&lt;p>称之为标准化部分和过程，它不再是离散的，而是一个连续过程。&lt;/p>
&lt;p>若 $S_n(r)$ 满足&lt;/p>
&lt;ol>
&lt;li>对任意 $r_1,\dots,r_m$，都有&lt;/li>
&lt;/ol>
&lt;p>$$(S_n(r_1),\dots,S_n(r_m))\to_d(S(r_1),\dots,S(r_m))$$&lt;/p>
&lt;ol start="2">
&lt;li>$S_n(r)$ &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Stochastic_equicontinuity">渐进等度连续 (asymptotically equicontinuous)&lt;/a>&lt;/em>。&lt;/li>
&lt;/ol>
&lt;p>则 $S_n(r) \to_d S(r)$。&lt;/p>
&lt;/div>
&lt;/div>
&lt;p>简单说一下两个条件的含义。第一个条件保证函数在任意有限个点处取值得到的有限维分布收敛，第二个条件是说随机过程作为一个函数族在概率意义上一致连续，是比单个函数一致连续更强的条件，这个条件将使得任意有限维的收敛足以确保函数在一个连续区间上的收敛。&lt;/p>
&lt;h2 id="一个例子">一个例子&lt;/h2>
&lt;p>设 $\{e_t(\omega)\}_{t=1}^\infty$ 是一个平稳遍历的鞅差分，方差为 $\sigma^2$，标准化部分和 $S_n(r)$ 依照前述定义。根据鞅差分中心极限定理（见 &lt;a href="../ecmt-notes-some-notions/">第三讲&lt;/a>），有&lt;/p>
&lt;p>$$
S_n(r) = \sqrt{\frac{\lfloor nr\rfloor}{n}}\frac{1}{\sqrt{\lfloor nr\rfloor}}\sum_{t=1}^{\lfloor nr\rfloor}e_t \to_d N(0,r\sigma^2)
$$&lt;/p>
&lt;p>此外，我们还可证明 $S_n(r_1)$ 和 $S_n(r_2)-S_n(r_1)$ 的联合分布渐进服从联合正态分布，协方差矩阵为 $\text{diag}\{r_1\sigma^2,(r_2-r_1)\sigma^2\}$。这事实上表明了 $S_n(r)$ 的极限分布具有布朗运动的性质。&lt;/p>
&lt;p>$S_n(r)$ 还是是渐进等度连续的，证明可见 Hansen 课本第 16.22 节。&lt;/p>
&lt;p>于是，根据 FCLT，$S_n(r)\to_d B(r)$。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Davidson, James (1994). &lt;em>Stochastic Limit Theory: An Introduction for Econometricians&lt;/em>. Oxford University Press.&lt;/p>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
&lt;br>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>严格来讲，此阶跃函数是右连左极函数，属于 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/C%C3%A0dl%C3%A0g#Skorokhod_space">Skorokhod 空间&lt;/a>&lt;/em>，也有在此空间上适用的 FCLT，但本文给出的 FCLT 不是某个函数空间内的函数列的收敛性，而是满足渐进等度连续函数列的收敛性。顺带一提，累积分布函数也是右连左极函数。&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
- https://gaxu.xyz/posts/ecmt-notes-fclt/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (IV)：时间趋势与收敛速率</title><link>https://gaxu.xyz/posts/ecmt-notes-time-trends/</link><pubDate>Tue, 25 Apr 2023 19:14:11 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-time-trends/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-time-trends/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>介绍了含时间趋势回归中 OLS 估计量的渐进分布，揭示了收敛速率的差异。&lt;/p>
&lt;h2 id="时间趋势回归">时间趋势回归&lt;/h2>
&lt;p>考虑线性回归模型&lt;/p>
&lt;p>$$
Y_t = \beta_0 + \beta_1 t + e_t
$$&lt;/p>
&lt;p>其中 ${e_t}$ 是平稳遍历的鞅差分，方差为 $\sigma^2$。&lt;/p>
&lt;p>假设我们有 $t=1,\dots,n$ 的样本，OLS 估计量（的偏误）就是&lt;/p>
&lt;p>$$
\begin{pmatrix}
\hat{\beta}_0-\beta_0 \\ \hat{\beta}_1-\beta_1
\end{pmatrix} =
\begin{pmatrix}
n &amp;amp; \sum_{t=1}^n t \\ \sum_{t=1}^n t &amp;amp; \sum_{t=1}^n t^2
\end{pmatrix}^{-1}
\begin{pmatrix}
\sum_{t=1}^n e_t \\ \sum_{t=1}^n te_t
\end{pmatrix}
$$&lt;/p>
&lt;p>很显然，$\frac1n\bm{X}'\bm{X}$ 是不收敛的，因为 $\sum_{t=1}^n t = O(n^2)$，$\sum_{t=1}^n t^2 = O(n^3)$。不过，我们可以做一些 rescaling 凑出收敛。&lt;/p>
&lt;p>首先将 $\bm{X}'\bm{X}$ 统一调成 $O(1)$，这意味着放缩因子是&lt;/p>
&lt;p>$$
\begin{pmatrix}
1 &amp;amp; \frac{1}{n^2} \\ \frac{1}{n^2} &amp;amp; \frac{1}{n^3}
\end{pmatrix}
$$&lt;/p>
&lt;p>能起到缩放作用的是对角矩阵，左乘一个对角矩阵意味着逐行放缩，右乘一个对角矩阵意味着逐列放缩。假设我们对 $\bm{X}'\bm{X}$ 左乘和右乘相同的矩阵 $\bm{D}_n^{-1} = \text{diag}\{a,b\}$，则必定有&lt;/p>
&lt;p>$$
a^2=\frac1n,\quad ab = \frac1{n^2},\quad b^2 = \frac{1}{n^3}
$$&lt;/p>
&lt;p>解当然不唯一，但我们取正值，也就是 $a = 1/\sqrt{n}$ 和 $b = n^{-3/2}$。&lt;/p>
&lt;p>于是，通过缩放，我们得到&lt;/p>
&lt;p>$$
\begin{align*}
\bm{D_n}
\begin{pmatrix}
\hat{\beta}_0-\beta_0 \\ \hat{\beta}_1-\beta_1
\end{pmatrix} &amp;amp;=
(\bm{D_n}^{-1}\bm{X}'\bm{X}\bm{D_n}^{-1})^{-1}\bm{D_n}^{-1}
\begin{pmatrix}
\sum_{t=1}^n e_t \\ \sum_{t=1}^n te_t
\end{pmatrix} \\
&amp;amp;=\begin{pmatrix}
1 &amp;amp; \frac{1}{n^2}\sum t \\ \frac{1}{n^2}\sum t &amp;amp; \frac{1}{n^3}\sum t^2
\end{pmatrix}^{-1}
\frac{1}{\sqrt{n}}\sum_{t=1}^n
\begin{pmatrix}
1 \\ \frac{t}{n}
\end{pmatrix}
e_t
\end{align*}
$$&lt;/p>
&lt;p>可以证明 $\frac{1}{n^2}\sum t\to\frac12$，$\frac{1}{n^3}\sum t^2\to\frac13$，因此&lt;/p>
&lt;p>$$
\bm{D_n}^{-1}\bm{X}'\bm{X}\bm{D_n}^{-1} \to
\begin{pmatrix}
1 &amp;amp; \frac12 \\ \frac12 &amp;amp; \frac13
\end{pmatrix}
$$&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>事实上，对任意 $r&amp;gt;0$，都有&lt;/p>
&lt;p>$$
\lim_{n\to\infty}\frac{1}{n^{1+r}}\sum_{t=1}^n t^r = \lim_{n\to\infty}\sum_{t=1}^n \left(\frac{t}{n}\right)^r\cdot\frac1n = \int_0^1 x^r\,dr = \frac{1}{1+r}
$$&lt;/p>
&lt;p>这里利用了 Riemann 积分的定义。&lt;/p>&lt;/div>
&lt;p>接下来，我们要考察第二个部分的渐进分布。前一讲的鞅差分 CLT 不足以用来证明，因为每一项的方差是变化的，需要回到 Davidson (1994) 定理24.3。不论如何，在 $e_t$ 是平稳遍历鞅差分的条件下，我们总可以使用中心极限定理，于是有&lt;/p>
&lt;p>$$
\frac{1}{\sqrt{n}}\sum_{t=1}^n
\begin{pmatrix}
1 \\ \frac{t}{n}
\end{pmatrix}
e_t
\to_d
N(\bm{0},\bm{\Sigma})
$$&lt;/p>
&lt;p>其中渐进方差 $\bm{\Sigma}$ 就是&lt;/p>
&lt;p>$$
\bm{\Sigma} = \lim_{n\to\infty} \sum_{t=1}^n\mathbb{E}\left[\begin{pmatrix}
1 \\ t/n
\end{pmatrix}(1,t/n)e_t^2\right] = \begin{pmatrix}
1 &amp;amp; 1/2 \\ 1/2 &amp;amp; 1/3
\end{pmatrix}\sigma^2
$$&lt;/p>
&lt;p>因此，$\bm{D_n}(\hat{\bm{\beta}}-\beta)$ 的渐进分布&lt;/p>
&lt;p>$$
\bm{D_n}(\hat{\bm{\beta}}-\beta) \to_d N(\bm{0},\bm{V}) \quad\text{where } \bm{V} = \sigma^2\begin{pmatrix}
1 &amp;amp; 1/2 \\ 1/2 &amp;amp; 1/3
\end{pmatrix}^{-1}
$$&lt;/p>
&lt;p>可以看到，$\hat{\beta}_1-\beta_1 = O_p(n^{-3/2})$，比 $\beta_0$ 有更快的收敛速度。这本质上是因为，$X_t = t$ 是一个非平稳的（尽管是确定性的）时间序列，非平稳性意味着序列失去均值回归的性质，因而大数定律失效，欲得到回归或者收敛性，必须使用更高阶的平均。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Davidson, James (1994). &lt;em>Stochastic Limit Theory: An Introduction for Econometricians&lt;/em>. Oxford University Press.&lt;/p>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-time-trends/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (III)：几个话题</title><link>https://gaxu.xyz/posts/ecmt-notes-some-notions/</link><pubDate>Mon, 24 Apr 2023 12:18:41 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-some-notions/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-some-notions/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>这一讲不是单个概念，而是好几个话题。因为单个的内容都比较少，所以我把它们都放在这里。当然，每一个话题都可以拓展为很丰富的内容，但由于课上也是选择性介绍的，这里我也就没有再去探索（留待以后），因为往后的重心是非平稳时间序列。&lt;/p>
&lt;p>介绍了鞅差分中心极限定理、线性投影和 Wold 分解定理。&lt;/p>
&lt;h2 id="鞅差分中心极限定理">鞅差分中心极限定理&lt;/h2>
&lt;p>&lt;em>鞅 (martingale)&lt;/em> 是一类非常重要的随机过程，&lt;em>鞅差分 (martingale difference sequence, m.d.s.)&lt;/em> 顾名思义就是鞅的差分。这里我们不通过鞅来定义鞅差分，而是直接给出鞅差分的定义：&lt;/p>
&lt;div class="thm">
&lt;p id="def:mds" class="thm-title thm-definition">Definition 1.&lt;/p>
&lt;div class="thm-inner thm-definition">
&lt;p>随机过程 $\{e_t\}$ 若适应于滤流 (filtration) $\{\mathcal{F}_t\}$ 且满足&lt;/p>
&lt;p>$$
\mathbb{E}(e_t|\mathcal{F_{t-1}}) = 0 \quad\text{almost surely}
$$&lt;/p>
&lt;p>则称之为鞅差分序列。&lt;/p>
&lt;/div>
&lt;/div>
&lt;p>容易验证一个 m.d.s. 是零均值、序列不相关的。&lt;/p>
&lt;p>不加证明地给出鞅差分中心极限定理：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:mds" class="thm-title thm-Theorem">Theorem 2.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>若 $\{e_t\}$ 是平稳遍历的 m.d.s.，且 $\mathbb{E}(e_t^2) = \sigma^2 &amp;lt;\infty$，则有&lt;/p>
&lt;p>$$
\sqrt{n}\bar{e}_n = \frac{1}{\sqrt{n}}\sum_{t=1}^ne_t \to_d N(0,\sigma^2)
$$&lt;/p>
&lt;/div>
&lt;/div>
&lt;p>此定理特别适合我们的需要，因为之前已经介绍了平稳和遍历，为了得到一个中心极限定理，只需额外要求序列是一个鞅差分。此定理的严格证明可参考 Davidson (1994) 定理 24.3，它事实上是 McLeish (1974) 鞅差分 CLT 的一个较弱的推论，平稳遍历将保证那个定理中的各项条件得到满足。&lt;/p>
&lt;p>课本中还介绍了 &lt;em>混合 (mixing)&lt;/em> 的概念，它是比遍历更强的要求，但思想是相同的，就是渐进独立性（见上一讲定理 4 下面的讨论）。这里不作更多介绍。&lt;/p>
&lt;h2 id="线性投影">线性投影&lt;/h2>
&lt;p>设 $(Y,\bm{X})$ 服从联合分布。$Y$ 可表示为两个部分，第一个部分是 $\bm{X}$ 的一个线性组合，第二个部分 $e$ 是正交于（即不相关）第一部分的误差；两者可分别称为 &lt;em>线性投影 (linear projection)&lt;/em> 和 &lt;em>投影误差 (projection error)&lt;/em>。&lt;/p>
&lt;p>那么，这个线性组合 $\bm{X}'\bm{\beta}$ 应该如何选取呢？或者说，以什么标准来确定最优的线性投影？这个问题的答案是，使得投影误差的 $L^2$ 范数最小化。也就是说，最好的 $\bm{\beta}^*$ 是&lt;/p>
&lt;p>$$
\bm{\beta}^* = \arg\min_{\bm{\beta}} \mathbb{E}[(Y-\bm{X}&amp;rsquo;\bm{\beta})^2]
$$&lt;/p>
&lt;p>解为 $\bm{\beta}^* = [\mathbb{E}(\bm{XX}')]^{-1}\mathbb{E}(\bm{X}Y)$。&lt;/p>
&lt;p>事实上，选择 $L^2$ 范数最小化来自于一个事实：条件期望 $\mathbb{E}(Y|\bm{X})$ 是 $Y$ 在 $L^2(\Omega,\sigma(\bm{X}),\mathbb{P})$ 空间上的投影，因此&lt;/p>
&lt;p>$$
\mathbb{E}(Y|\bm{X}) \in \arg\min_g \mathbb{E}[(Y-g(\bm{X}))^2]
$$&lt;/p>
&lt;p>当条件期望为线性时，正好有 $\bm{X}'\bm{\beta}^* = \mathbb{E}(Y|\bm{X})$。&lt;/p>
&lt;p>在时间序列中，线性投影特别有用，尤其在（平稳时间序列）预测中。这是因为当我们对时间序列施加平稳性假设时，线性投影和相应的投影误差将是正交的。这一结论导出自著名的 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Hilbert_projection_theorem">Hilbert 投影定理&lt;/a>&lt;/em>，陈述如下：（注：Hibert 空间，即完备内积空间）&lt;/p>
&lt;div class="thm">
&lt;p id="thm:hilbert" class="thm-title thm-Theorem">Theorem 3.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>设 $\mathcal{H}_0$ 是 Hilbert 空间 $\mathcal{H}$ 的一个闭的子空间。对任意 $f\in\mathcal{H}$，存在唯一的 $f_0\in\mathcal{H}_0$，使得&lt;/p>
&lt;ol>
&lt;li>$f_0 = \min_{h\in\mathcal{H}_0} \|f-h\|$；&lt;/li>
&lt;li>$f-f_0$ 和 $\mathcal{H_0}$ 正交。&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/div>
&lt;p>回到时间序列，我们有如下定理：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:proj" class="thm-title thm-Theorem">Theorem 4.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>若 $\{Y_t\}$ 协方差平稳，则它有投影方程&lt;/p>
&lt;p>$$
Y_t = \mathcal{P}_{t-1}[Y_t] + e_t
$$&lt;/p>
&lt;p>其中 $\mathcal{P}_{t-1}[Y_t]$ 是 $Y_t$ 到 $(\dots,Y_{t-2},Y_{t-1})$ 上的最优线性投影（最小化误差的 $L^2$ 范数），且投影误差序列不相关，方差有限。&lt;/p>
&lt;p>若 $\{Y_t\}$ 严格平稳，除上述结果外，还有 $\{e_t\}$ 也是严格平稳的。&lt;/p>
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-1" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>需要首先指出，投影方程取决于有多少期的数据可得。假设有 $n$ 期的历史 $(Y_{t-n},\dots,Y_{t-2},Y_{t-1})$，那么线性子空间&lt;/p>
&lt;p>$$
\text{span}(\{Y_{t-n},\dots,Y_{t-2},Y_{t-1}\}) = \left\{\sum_{j=1}^na_jY_{t-j}\colon a_j\in\mathbb{R},Y_{t-j}\in L^2(\mathbb{P})\right\}
$$&lt;/p>
&lt;p>一定是闭的（对极限封闭），容易证明由有限集张成的线性空间一定是闭的。&lt;/p>
&lt;p>根据 Hilbert 投影定理，我们就可以确定投影方程。此外，投影误差序列不相关，且是平稳的（严格平稳的），这可由 $\{Y_t\}$ 平稳性（严格平稳性）得到。&lt;/p>
&lt;p>需要指出，将 $Y_t$ 投影到无穷维线性空间 $\text{span}(\{\dots,Y_{t-2},Y_{t-1}\})$ 不一定可行，因为无穷维线性子空间不一定是闭的。当然，我们可以取其闭包得到一个闭的子空间，但这个空间内并不是所有元素都一定可表为 $\{\dots,Y_{t-2},Y_{t-1}\}$ 的线性组合，相应地我们需要修改 $\mathcal{P}_{t-1}$ 的定义，使之不限于线性投影。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-1">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>书中认为 $\{e_t\}$ 均值为0，这无法得到，除非 $\{Y_t\}$ 本身零均值，或者在投影中包含常数项。本质上，我们还是在用线性组合去逼近真正的条件期望 $\mathbb{E}_{t-1}(Y_t)$。&lt;/p>&lt;/div>
&lt;h2 id="wold-分解">Wold 分解&lt;/h2>
&lt;p>Wold 分解表明，一个协方差平稳的时间序列可被分解为一个 $\text{MA}(\infty)$ 过程和一个确定性过程（确定是指完全由历史决定），两部分互不相关。以下的定理是不太严格的表述，严格表述及证明可见于 Brockwell and Davis (1991) 定理 5.7.1。Hansen 书中依然遗漏了「零均值」条件，没有这个条件 $e_t$ 的均值不必然为 0；当然这也不是什么问题，对于平稳序列，我们总是可以先除均值，然后将均值归入以下的确定性部分 $\mu_t$。&lt;/p>
&lt;div class="thm">
&lt;p id="thm:wold" class="thm-title thm-Theorem">Theorem 5.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>若 &lt;em>零均值&lt;/em> 时间序列 $\{Y_t\}$ 协方差平稳且投影误差的方差 $\sigma^2 &amp;gt; 0$，则 $Y_t$ 可分解为&lt;/p>
&lt;p>$$
Y_t = \sum_{j=0}^\infty b_je_{t-j} + \mu_t
$$&lt;/p>
&lt;p>其中 $b_0 = 1$，$\sum_{j=0}^\infty b_j^2 &amp;lt; \infty$；$e_t$ 是方差为 $\sigma^2$ 的白噪声序列，且和 $\mu_t$ 无关；$\mu_t$ 是由 $Y_t$ 的历史决定的确定性过程。&lt;/p>
&lt;/div>
&lt;/div>
&lt;p>可以看到 Wold 分解和 ARMA 模型的深刻联系，它事实上为后者提供了理论基础。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Brockwell, Peter J., and Richard A. Davis (1991). &lt;em>Time Series: Theory and Methods&lt;/em>. Springer Science &amp;amp; Business Media.&lt;/p>
&lt;p>Davidson, James (1994). &lt;em>Stochastic Limit Theory: An Introduction for Econometricians&lt;/em>. Oxford University Press.&lt;/p>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-some-notions/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (II)：遍历性</title><link>https://gaxu.xyz/posts/ecmt-notes-ergodicity/</link><pubDate>Sat, 22 Apr 2023 20:22:42 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-ergodicity/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-ergodicity/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>引入一个重要概念：&lt;em>遍历性 (ergodicity)&lt;/em>，并证明了（弱版本的）遍历定理，该定理是时间序列版本的大数定律。&lt;/p>
&lt;h2 id="遍历性">遍历性&lt;/h2>
&lt;p>上一讲介绍了平稳性，它本质上诱导出一个保测变换。但平稳性仍不足以建立起大数定律，例如，考虑一个平凡的时间序列 $Y_t = Y$，它没有任何时间维度上的变动，很显然，它是平稳的，然而 $\frac1n\sum Y_t = Y$ 并不收敛到 $\mathbb{E}(Y)$。大数定律还需要时间序列是遍历的。顺带一提，遍历性理论已经发展成了一个数学分支，在时间序列中的应用只是其诸多应用之一。&lt;/p>
&lt;p>在定义遍历性之前我们先介绍一些必要概念。称事件 $A$ 在变换 $T$ 下是 &lt;em>不变的(invariant)&lt;/em> 若 $A$ 在 $T$ 下的原像也是 $A$，即 $T^{-1}A = A$。例如，在时间序列中，我们接触到最多的变换之一就是时间位移变换 $(\delta x)_t = x_{t+1}$，很显然，$\mathbb{R}^{\mathbb{Z}}$ 在 $\delta$ 下就是不变的。称事件 $A$ 是 &lt;em>平凡的(trivial)&lt;/em> 如果 $\mathbb{P}(A)$ 等于 0 或 1。称一个变换 $T$ 是 &lt;em>遍历的&lt;/em> 若所有在 $T$ 下不变的事件 $A\in\mathcal{F}$（$\mathcal{F}$ 是 $\sigma$ 域）都是平凡的，换言之，没有非平凡不变事件。&lt;/p>
&lt;p>现在给出时间序列遍历性的正式定义：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:ergod" class="thm-title thm-definition">Definition 1.&lt;/p>
&lt;div class="thm-inner thm-definition">
设时间序列 $\{Y_t\}_{t\in\mathbb{Z}}$ 的分布为 $\mu$，相应地有概率空间 $(\mathbb{R}^{\mathbb{Z}},\mathcal{B}(\mathbb{R}^{\mathbb{Z}}),\mu)$。若位移变换 $\delta: \mathbb{R}^{\mathbb{Z}}\to\mathbb{R}^{\mathbb{Z}}$ 是遍历的，则称 $\{Y_t\}$ 是遍历的。
&lt;/div>
&lt;/div>
&lt;p>可以看到，数学上，平稳性要求位移变换是一个保测变换（见上一讲对定理 2 的证明，在那里还说明了像测度 $\mu$ 是如何定义的），而遍历性要求位移变换是遍历的。那么，该如何理解遍历性呢？直观来讲，它意味着一个时间序列随着时间的演进将最终到达样本空间内的所有状态，而被吸收到特定状态的概率为零。可以想见，当一个时间序列既是平稳又是遍历的，那么一条样本路径随机而均匀地（此处「均匀」指按照单个 $Y_t$ 分布的均匀）访问了整个样本空间，于是它们的样本均值就能很好地刻画总体均值，这就是遍历定理的基本思想。&lt;/p>
&lt;h3 id="遍历序列的变换">遍历序列的变换&lt;/h3>
&lt;p>和平稳性一样，对一个遍历序列的（可测）变换仍保留遍历性：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:trans" class="thm-title thm-Theorem">Theorem 2.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
若 $\{Y_t\}$ 是遍历序列，则对任意可测变换 $\phi\colon\mathbb{R}^{\mathbb{Z}}\to \mathbb{R}$，$X_t := \phi(Y_t,Y_{t-1},\dots)$ 仍是遍历的。
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-1" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>设 $\{X_t\}$ 的分布为 $\lambda$，它是 $\mu$ 在 $T\colon\mathbb{R}^{\mathbb{Z}}\to\mathbb{R}^{\mathbb{Z}}$ 下的像测度，$T$ 由下式定义：&lt;/p>
&lt;p>$$
(Tx)_t = \phi(y_t, y_{t-1},\dots)
$$&lt;/p>
&lt;p>我们要证明位移变换在 $\lambda$ 的意义下是遍历的，即任意 $\delta$-invariant 事件 $A$ 都是平凡的。&lt;/p>
&lt;p>由 $\{Y_t\}$ 的遍历性，对任意 $\delta$-invariant 事件 $A$，有 $\mu(A) = 0$ 或 $\mu(A) = 1$。根据 $\lambda$ 的定义，有&lt;/p>
&lt;p>$$
\lambda(A) = \mu(T^{-1}A)
$$&lt;/p>
&lt;p>若能证明 $T^{-1}A$ 也是 $\delta$-invariant 事件，则我们就证明了 $\{X_t\}$ 是遍历的。&lt;/p>
&lt;p>容易推出 $\delta^{-1}(T^{-1}A) = \{x\colon T(\delta x)\in A\}$；由 $T$ 的定义，易见 $T(\delta x) = \delta(Tx)$；再由 $A$ 的不变性有 $\delta x\in A$ 当且仅当 $x\in A$；因此，有 $T(\delta x)\in A$ 当且仅当 $Tx\in A$，这也就证明了 $\delta^{-1}(T^{-1}A) = T^{-1}A$，即 $T^{-1}A$ 是 $\delta$-invariant 事件。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-1">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>特别地，移动平均变换保留遍历性：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:conv" class="thm-title thm-Theorem">Theorem 3.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
若 $\{Y_t\}$ 遍历，$\mathbb{E}|Y|&amp;lt;\infty$，且 $\sum_{j=0}^\infty|a_j| &amp;lt; \infty$，则 $X_t = \sum_{j=0}^\infty a_jY_{t-j}$ 收敛且遍历。
&lt;/div>
&lt;/div>
&lt;h2 id="遍历定理">遍历定理&lt;/h2>
&lt;p>遍历定理是时间序列版本的大数定律，是我们在非独立世界中实现一致估计的基石。在表述该定理之前，先不加证明地给出一个平稳序列遍历的充要条件：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:mix" class="thm-title thm-Theorem">Theorem 4.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
&lt;p>若 $\{Y_t\}$ 平稳，则其遍历的充要条件是：对任意事件 $A,B\in\mathcal{B}(\mathbb{R}^{\mathbb{Z}})$，有&lt;/p>
&lt;p>$$
\lim_{n\to\infty} \frac1n\sum_{k=1}^n\mu(\delta^kA\cap B) = \mu(A)\mu(B)
$$&lt;/p>
&lt;/div>
&lt;/div>
&lt;p>其严格证明可见 Davidson (1994) 定理 13.13。这里提供一种直觉解释。在保测且遍历的位移变换下，非平凡的事件 $A$ 在位移后和会得到 $A$ 和其补集 $A^c$ 元素的某种混合（因为 $A$ 肯定不是 invariant），随着时间的演进，不停地进行位移变换，我们可以得到不同程度的混合。对于另一个事件 $B$，它和 $\delta^k A$ 的相关程度由 $\mu(\delta^kA\cap B)-\mu(A)\mu(B)$ 刻画，这些相关性平均下来，应该接近零，这是因为：$\delta^kA$ 会是 $A$ 和 $A^c$ 各种程度的混合，也决定了它和 $B$ 的相关性，但平均值应该接近零。&lt;/p>
&lt;p>从以上定理我们有如下推论：&lt;/p>
&lt;div class="thm">
&lt;p id="coro:cov" class="thm-title thm-Corollary">Corollary 5.&lt;/p>
&lt;div class="thm-inner thm-Corollary">
&lt;p>若 $\{Y_t\}$ 平稳且遍历，以及 $\mathbb{E}(Y^2)&amp;lt;\infty$，则对任意 $t\in\mathbb{Z}$，有&lt;/p>
&lt;p>$$
\frac1n\sum_{k=1}^n\text{cov}(Y_t,Y_{t+k}) \to 0 \quad\text{as } n\to\infty
$$&lt;/p>
&lt;p>即平均协方差趋于零。&lt;/p>
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-2" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>不失一般性，假设 $\mathbb{E}(Y) = 0$。记 $\gamma_k = \mathbb{E}(Y_tY_{t+k})$。我们要证明 $\frac1n\sum_k\gamma_k \to 0$。&lt;/p>
&lt;p>以概率测度 $\mu$ 来表述，$\gamma_k = \int \pi_0(x)\pi_k(x)\,\mu(dx)$，其中 $\pi_k(x) = x_{t+k}$ 是坐标投影映射。考虑 $\pi_0$ 为简单函数的情况，即 $\pi_0(x) = \sum_i \alpha_i\mathbb{1}_{A_i}(x)$，其中 $\{A_i\}$ 构成对 $\mathbb{R}^{\mathbb{Z}}$ 的分割。于是 $\pi_1(x) = \pi_0(\delta^{-1} x) = \sum_i\alpha_i\mathbb{1}_{\delta^{-1}A_i}(x)$。不难证明 $\{\delta^{-1}A_i\}$ 两两互斥，且它们的概率和为 1（利用 $\delta$ 的保测性），因此我们就可以把它视作对 $\mathbb{R}^{\mathbb{Z}}$ 的分割。这可以自然地推广到 $\pi_k$。因此&lt;/p>
&lt;p>$$
\begin{align*}
\gamma_k &amp;amp;= \int \sum_i\sum_j\alpha_i\alpha_j\mathbb{1}_{A_i\cap\delta^{-k}A_j}(x)\,\mu(dx) \\
&amp;amp;= \sum_i\sum_j\alpha_i\alpha_j\mu(A_i\cap\delta^{-k}A_j)
\end{align*}
$$&lt;/p>
&lt;p>根据前述定理，就有&lt;/p>
&lt;p>$$
\begin{align*}
\lim_{n\to\infty}\frac1n\sum_k\gamma_k &amp;amp;= \sum_i\sum_j\alpha_i\alpha_j\left(\lim_{n\to\infty}\frac1n\sum_k\mu(A_i\cap\delta^{-k}A_j)\right) \\
&amp;amp;= \sum_i\sum_j\alpha_i\alpha_j\mu(A_i)\mu(A_j) \\
&amp;amp;= [\mathbb{E}_{\mu}(\pi_0)]^2 = 0
\end{align*}
$$&lt;/p>
&lt;p>最后，根据测度论中任意可测函数可由简单函数的递增序列逼近的性质，以及单调收敛定理，便可将上述结论拓展到一般情形。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-2">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>值得一提，平均协方差趋于零并不意味着单项协方差也趋于零，换言之，遍历不意味着序列无关（即便是渐进意义上）；反过来，序列无关也不意味着遍历（一个反例可见 &lt;a href="https://math.stackexchange.com/a/526387/693430">这里&lt;/a>）。&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>在数学分析中，我们知道，若数列 $a_n$ 有极限 $a$，那么算数平均 $\frac1n\sum a_i$ 收敛且有相同极限 $a$，但反过来并不成立，例如 $a_n = (-1)^n$ 不收敛，但 $\frac1n\sum a_i$ 收敛到零。这个结论常被称作 &lt;a href="https://en.wikipedia.org/wiki/Ces%C3%A0ro_summation">Cesàro summation&lt;/a>。&lt;/p>&lt;/div>
&lt;p>下面，我们利用上述推论证明一个弱版本的遍历定理。在强版本里，不需要二阶矩存在，而且得到的是几乎确定收敛（和强大数定律一样），其证明可见 Billingsley (1995) 定理 24.1 或者 Davidson (1994) 定理 13.12，有时间我会专门写一篇笔记。&lt;/p>
&lt;div class="thm">
&lt;p id="thm:ergo" class="thm-title thm-Theorem">Theorem 6.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
若 $\{Y_t\}$ 平稳且遍历，以及 $\mathbb{E}(Y^2)&amp;lt;\infty$，则 $\frac1n\sum Y_t\to_p\mathbb{E}(Y)$。
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-3" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>记 $\bar{y}_n = \frac1n\sum Y_t$ 为样本均值。&lt;/p>
&lt;p>由 Chebyshev 不等式&lt;/p>
&lt;p>$$
\mathbb{P}(|\bar{y}_n-\mu|\geq\varepsilon) \leq \frac{\text{var}(\bar{y}_n)}{\varepsilon^2}
$$&lt;/p>
&lt;p>我们只要证明 $\lim_{n\to\infty}\text{var}(\bar{y}_n)=0$。&lt;/p>
&lt;p>不失一般性，假设 $\mu = 0$。我们有&lt;/p>
&lt;p>$$
\begin{align*}
\text{var}(\bar{y}_n) &amp;amp;= \frac{1}{n^2}\mathbb{E}[(Y_1+\dots+Y_T)^2] \\
&amp;amp;= \frac{1}{n^2}[n\gamma_0 + 2(n-1)\gamma_1 + 2(n-2)\gamma_2 +\dots+ 2\gamma_{n-1}] \\
&amp;amp;= \frac{1}{n^2}\left[n\gamma_0+2\sum_{k=1}^{n-1}(n-k) \gamma_k\right] \\
&amp;amp;= \frac{1}{n^2}\left[n\gamma_0+2\sum_{k=1}^{n-1}\sum_{\ell=1}^k\gamma_\ell\right] \\
&amp;amp;= \frac{\gamma_0}{n} + \frac{2}{n}\sum_{k=1}^{n-1}\left(\frac{1}{n}\sum_{\ell=1}^k\gamma_\ell\right)
\end{align*}
$$&lt;/p>
&lt;p>第一项显然收敛到0；由前述推论，第二项括号内趋于0，再由 Cesàro 求和的结论知整个第二项趋于0。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-3">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Billingsley, Patrick (1995). &lt;em>Probability and Measure&lt;/em>. John Wiley &amp;amp; Sons.&lt;/p>
&lt;p>Davidson, James (1994). &lt;em>Stochastic Limit Theory: An Introduction for Econometricians&lt;/em>. Oxford University Press.&lt;/p>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
&lt;p>Petersen, Karl E. (1989). &lt;em>Ergodic Theory.&lt;/em> Cambridge University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-ergodicity/ - 2023–2024 嘉树.</description></item><item><title>计量复习笔记 (I)：严格平稳性</title><link>https://gaxu.xyz/posts/ecmt-notes-stationarity/</link><pubDate>Sat, 22 Apr 2023 00:58:32 +0800</pubDate><guid>https://gaxu.xyz/posts/ecmt-notes-stationarity/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ecmt-notes-stationarity/ -&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice info" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#info-notice">&lt;/use>&lt;/svg>&lt;/span>Info&lt;/p>&lt;p>本系列是2023年春季学期《应用计量经济学》期末复习笔记，仅涵盖时间序列部分，对应 Hansen (2022) &lt;em>Econometrics&lt;/em> 第14和16章的内容。&lt;/p>&lt;/div>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>介绍了时间序列中的一个重要概念：严格平稳性（如无特别说明，平稳性均指代严格平稳），并证明了对平稳序列的任意（可测）变换所得序列仍是平稳的（原书定理 14.2）。&lt;/p>
&lt;h2 id="平稳时间序列">平稳时间序列&lt;/h2>
&lt;p>对于构建时间序列的严格且正式的理论而言，我们需要的是严格平稳性，弱平稳（宽平稳、协方差平稳）是不足够的。平稳性对于一列随机变量序列，即随机过程，施加了特别的结构，从而使我们在离开独立性世界后依然能发展出类似大数定律、中心极限定理的重要理论。&lt;/p>
&lt;p>首先给出严格平稳时间序列的定义：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:stationary" class="thm-title thm-definition">Definition 1.&lt;/p>
&lt;div class="thm-inner thm-definition">
随机过程 $\{Y_t\}_{t\in\mathbb{Z}}$ 若满足：给定任意的 $r\in\mathbb{Z}$，$(Y_t,\dots,Y_{t+r})$ 的联合分布与 $t$ 无关，则称之为平稳过程。
&lt;/div>
&lt;/div>
&lt;p>以随机过程的术语来说，平稳时间序列的分布具有 &lt;em>位移不变 (shift-invariant)&lt;/em> 的性质。如果我们采用测度论的严格表述，就是：对于 $\mathbb{R}$ 的任意 Borel 子集 $B_0,B_2,\dots,B_r$，以及任意的 $t$ 和 $\tau$，都有&lt;/p>
&lt;p>$$
\mathbb{P}\{\omega\colon Y_t(\omega)\in B_0,\dots,Y_{t+r}(\omega)\in B_r\} = \mathbb{P}\{\omega\colon Y_\tau(\omega)\in B_0,\dots,Y_{\tau+r}(\omega)\in B_r\}
$$&lt;/p>
&lt;p>这就是在表述 $(Y_t,\dots,Y_{t+r})$ 和 $(Y_{\tau},\dots,Y_{\tau+r})$ 具有相同分布。&lt;/p>
&lt;p>值得一提，有时我们会看到略有不同的定义：&lt;/p>
&lt;blockquote>
&lt;p>若对任意的 $t_1,t_2,\dots,t_r$，$(Y_{t_1},\dots,Y_{t_r})$ 的联合分布与 $(Y_{t_1+k},\dots,Y_{t_r+k})$ 相同，而与 $k$ 无关，则称 ${Y_t}$ 是平稳序列。&lt;/p>
&lt;/blockquote>
&lt;p>乍一看，这个定义似乎更一般，但它和上面的定义是等价的。要从前述定义推出此定义，只需注意到联合分布相同，则边缘分布必定相同，而 $(Y_{t_1},\dots,Y_{t_r})$ 的分布实际上就是 $(Y_t)_{t=t_1}^{t_r}$ 的边缘分布（不失一般性，假设 $t_1,\dots,t_r$ 由小到大排列）。&lt;/p>
&lt;h3 id="平稳时间序列的变换">平稳时间序列的变换&lt;/h3>
&lt;p>现在给出一个很强大的定理，它表明了平稳时间序列在任意可测变换下仍可保留平稳性。&lt;/p>
&lt;div class="thm">
&lt;p id="thm:trans" class="thm-title thm-Theorem">Theorem 2.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
若 $\{Y_t\}$ 是平稳序列，则对任意可测变换 $\phi\colon\mathbb{R}^{\mathbb{Z}}\to \mathbb{R}$，$X_t := \phi(Y_t,Y_{t-1},\dots)$ 仍是平稳的。
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-1" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>此证明是以测度论表述的严格证明，因为涉及到无穷维的情况。&lt;/p>
&lt;p>我们先定义整个随机过程 $\{Y_t\}$ 的分布。设 $T\colon\Omega\to\mathbb{R}^{\mathbb{Z}}$ 以 $(T\omega)_t = Y_t(\omega)$ 作为定义，换言之，$T\omega$ 是一个无穷维向量。设 $\mu$ 是 $\mathbb{P}$ 在 $T$ 下的像测度，即有&lt;/p>
&lt;p>$$
\mu(E) = \mathbb{P}(T^{-1}E) \quad\text{for each } E\in\mathcal{B}(\mathbb{R}^{\mathbb{Z}})
$$&lt;/p>
&lt;p>$\mu$ 描述了 $\{Y_t\}$ 的分布。&lt;/p>
&lt;p>现在，我们在无穷维空间 $\mathbb{R}^{\mathbb{Z}}$ 上定义一个 &lt;em>位移变换&lt;/em> $\delta\colon\mathbb{R}^{\mathbb{Z}}\to\mathbb{R}^{\mathbb{Z}}$：&lt;/p>
&lt;p>$$
(\delta x)_t = x_{t+r}
$$&lt;/p>
&lt;p>也就是说，$\delta$ 将给定的坐标移位 $r$ 个维度。这在时间序列中便是滞后算子。&lt;/p>
&lt;p>我们要证明 $\delta$ 是一个 $\mu$-&lt;em>&lt;a href="https://en.wikipedia.org/wiki/Measure-preserving_dynamical_system">保测变换&lt;/a>&lt;/em>（或称 $\mu$ 在 $\delta$ 下是 invariant）：&lt;/p>
&lt;p>$$
\mu(\delta^{-1}E) = \mu(E) \quad\text{for each } E\in\mathcal{B}(\mathbb{R}^{\mathbb{Z}})
$$&lt;/p>
&lt;p>根据 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Carath%C3%A9odory%27s_extension_theorem">Carathéodory 扩张定理&lt;/a>&lt;/em>，我们不需要证明上式对任意 Borel 子集成立，而只需证明对某个能生成 $\mathcal{B}(\mathbb{R}^{\mathbb{Z}})$ 的代数（对有限交、并、补封闭）的所有子集成立。我们选取的这个代数就是所有 $\mathbb{R}^{\mathbb{Z}}$ 的 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Cylinder_set">圆柱&lt;/a>&lt;/em> 子集构成的集族，记作 $\mathcal{C}$。&lt;/p>
&lt;p>$\mathbb{R}^{\mathbb{Z}}$ 的一个圆柱子集定义为如下形式：&lt;/p>
&lt;p>$$
C = \{(\dots,x_{-1},x_0,x_1,\dots)\in\mathbb{R}^{\mathbb{Z}}\colon (x_{t_1},x_{t_2},\dots,x_{t_n})\in B\}
$$&lt;/p>
&lt;p>其中 $B\in\mathbb{R}^n$ 是一个 Borel 子集。&lt;/p>
&lt;p>容易证明，$\mathcal{C}$ 是一个代数，并且其生成的 $\sigma$ 域 $\sigma(\mathcal{C})$ 正好是 $\mathcal{B}(\mathbb{R}^{\mathbb{Z}})$。这样，我们只需证明 $\delta$ 在 $\mathcal{C}$ 上保测，而根据 $Y_t$ 的平稳性，这显然成立。于是，$\delta$ 是一个保测变换。&lt;/p>
&lt;p>上面的证明立即表明，无穷维向量 $\widetilde{Y}_t:=(Y_t, Y_{t-1},\dots)$ 和其任意移位变换 $(Y_{t+r},Y_{t+r-1},\dots)$ 具有相同分布，进而 $x_t = \phi(\widetilde{Y}_t)$ 是平稳的。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-1">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>在时间序列中，我们经常用到的一个特殊变换就是移动平均，即 $Y_t,Y_{t-1},\dots$ 的线性组合：&lt;/p>
&lt;p>$$
X_t = \sum_{j=0}^\infty a_jY_{t-j}
$$&lt;/p>
&lt;p>当然，我们要求这个级数是几乎确定收敛的，一般情况下，我们省略限定语「几乎确定」。毫无疑问，根据上面的定理，$X_t$ 是平稳的。现在给出 $X_t$ 收敛的充分条件：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:conv" class="thm-title thm-Theorem">Theorem 3.&lt;/p>
&lt;div class="thm-inner thm-Theorem">
若 $\{Y_t\}$ 平稳，$\mathbb{E}|Y|&amp;lt;\infty$，且 $\sum_{j=0}^\infty|a_j| &amp;lt; \infty$，则 $X_t$ 收敛且平稳。
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-2" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>记 $S_n = \sum_{j=0}^n a_jY_{t-j}$ 为部分和序列。&lt;/p>
&lt;p>根据 Cauchy 收敛准则，$X_t$ 收敛的充要条件是：对于任意的 $\varepsilon&amp;gt;0$，存在 $N$，当 $n&amp;gt;N$ 时，我们有&lt;/p>
&lt;p>$$
\sup_{p\geq1}|S_{n+p}-S_n| &amp;lt; \varepsilon
$$&lt;/p>
&lt;p>我们要证明这个条件几乎处处成立。这等价于证明以下事件&lt;/p>
&lt;p>$$
A_{\varepsilon} := \bigcap_{n=1}^\infty A_{\varepsilon,n} = \bigcap_{n=1}^\infty\left\{\omega\colon\sup_{p\geq1}\left|\sum_{j=n+1}^{n+p}a_jY_{t-j}\right|\geq\varepsilon\right\}
$$&lt;/p>
&lt;p>总是零测集（而不论 $\varepsilon&amp;gt;0$ 的取值）。&lt;/p>
&lt;p>有如下关系成立：&lt;/p>
&lt;p>$$
\begin{align*}
\mathbb{P}(A_\varepsilon) &amp;amp;\leq \mathbb{P}(A_{\varepsilon,n}) \\
&amp;amp;\leq \frac{1}{\varepsilon}\mathbb{E}\left[\sup_{p\geq1}\left|\sum_{j=n+1}^{n+p}a_jY_{t-j}\right|\right] \\
&amp;amp;\leq \frac{1}{\varepsilon}\mathbb{E}\left[\sup_{p\geq1}\sum_{j=n+1}^{n+p}|a_j||Y_{t-j}|\right] \\
&amp;amp;= \frac{1}{\varepsilon}\mathbb{E}\left[\lim_{p\to\infty}\sum_{j=n+1}^{n+p}|a_j||Y_{t-j}|\right] \\
&amp;amp;= \frac{1}{\varepsilon}\lim_{p\to\infty}\mathbb{E}\left[\sum_{j=n+1}^{n+p}|a_j||Y_{t-j}|\right] \\
&amp;amp;= \frac{1}{\varepsilon}\lim_{p\to\infty}\sum_{j=n+1}^{n+p}|a_j|\mathbb{E}|Y|
\end{align*}
$$&lt;/p>
&lt;p>第二行来自 Markov 不等式；第三行来自三角不等式；第五行是单调收敛定理；第六行是积分的线性性。现在，再令 $n\to\infty$，由 $\sum |a_j|&amp;lt;\infty$，以及 $Y$ 绝对可积，进而得到 $\mathbb{P}(A_\varepsilon) = 0$。事实上，上述证明不仅表明 $X_t$ 是收敛的，还是绝对收敛的。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-2">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>Ulcigrai, Corinna. &lt;em>&lt;a href="https://indico.ictp.it/event/8325/session/1/contribution/9/material/0/0.pdf">Lecture Notes on &amp;ldquo;Measure preserving transformations.&amp;rdquo;&lt;/a>&lt;/em>&lt;/p>
&lt;p>Hansen, Bruce (2022). &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/p>
&lt;p>Petersen, Karl E. (1989). &lt;em>Ergodic Theory.&lt;/em> Cambridge University Press.&lt;/p>
- https://gaxu.xyz/posts/ecmt-notes-stationarity/ - 2023–2024 嘉树.</description></item><item><title>矩阵的秩、核范数与矩阵补全</title><link>https://gaxu.xyz/posts/nuclear-norm-min/</link><pubDate>Sat, 08 Apr 2023 16:06:52 +0800</pubDate><guid>https://gaxu.xyz/posts/nuclear-norm-min/</guid><description>嘉树的世界 https://gaxu.xyz/posts/nuclear-norm-min/ -&lt;p>大约三周以前，听了一个presentation，讲到了 network 研究中度量关系网络的矩阵的 &lt;em>「低秩」(low rank)&lt;/em> 性质。之后我在浏览一些高维计量文章时，又见到了这个概念，以及 &lt;em>「核范数」(nuclear norm, aka trace norm)&lt;/em>。我印象里应该见过它们很多次，有些模糊的记忆片段，突然想起和硕士期间导师的交流中他提到过，遂从聊天记录中找到一些珍贵文件，当时他让我学习一下关于 &lt;em>「矩阵补全」(matrix recovery, or matrix completion)&lt;/em> 的内容，我没来得及看。那么这几天就学习学习，说不定以后能派上用场。&lt;/p>
&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>本文将从矩阵恢复问题出发，介绍秩的最小化问题如何转变为一个核范数的最小化问题，前者是一个非凸的优化问题，很难求解，后者是一个凸优化问题，尽管不可求微分，但凸问题总是更易于求解的。&lt;/p>
&lt;h2 id="motivation">Motivation&lt;/h2>
&lt;p>我们所感兴趣的问题是，如何基于非常有限的信息复原一个（低秩）矩阵。这一话题原本来自于工程实践的需要，例如计算机视觉领域的图像降噪，我们知道图像是由像素点构成的，因而整个图像可以视为一个大矩阵，当有一些像素被破坏，得到的就是一个不完整的矩阵，对图像降噪就是要补全那些污损或缺失的像素点；又如著名的 Netflix 问题（类似地，在国内语境下是豆瓣问题）：Netflix 用户评分矩阵只包含了某些用户对某些电影的评分，而不是每个用户对所有电影的评分（如下图所示），我们希望能推测出那些缺失的评分。这些问题都涉及到矩阵补全。&lt;/p>
&lt;figure id = "fig:ratings" align="" role="group" aria-describedby="caption-7a0da52ea67b6a781291fe53e8b9f6fe">
&lt;a href="https://gaxu.xyz/posts/nuclear-norm-min/rating-mat.png" class="img-link">
&lt;img src="https://gaxu.xyz/posts/nuclear-norm-min/rating-mat.png" style="width: 60%;">
&lt;/a>
&lt;figcaption id="caption-7a0da52ea67b6a781291fe53e8b9f6fe">
Rating Matrix (Source: Yuejie Chi, 2018, Lecture Notes)
&lt;/figcaption>
&lt;/figure>
&lt;p>那么，这和低秩又有什么关系呢？很显然，在没有任何限制条件下去补全那些未知的项，我们有无数种填充方式。想要唯一地重建一个矩阵，这个矩阵必须有些特殊的结构作为限制，而低秩就是一个合理的结构。低秩意味着，矩阵的列向量高度线性相关──它们扩展形成的线性空间是低维的。说得更加人话就是，数据中的大部分波动都由少数几个因子驱动。&lt;/p>
&lt;p>现在可能又要问了，低秩在实践中是一个合理的假设吗？以 Netflix 评分矩阵为例，直觉上，同一类用户群体的行为、特征有很高的相似性，因此他们的潜在评分高度一致，这样评分矩阵的「主成分」实际上就是几个群体的评价，从而是低秩的。&lt;/p>
&lt;h2 id="核范数最小化">核范数最小化&lt;/h2>
&lt;p>低秩矩阵的补全可分为两类方法 (Gu &lt;i>et al.&lt;/i>
2014)：&lt;em>矩阵分解法&lt;/em> 和 &lt;em>求解秩最小化问题法&lt;/em>。前者用两个低秩矩阵之积作为构造方式，可留待以后学习；后者是本文要讨论的内容。&lt;/p>
&lt;h3 id="秩最小化问题的正式表述">秩最小化问题的正式表述&lt;/h3>
&lt;p>假设真实矩阵是 $\bm{M}$，我们所观测到的元素集合是 $\{M_{i,j}\colon (i,j)\in\Omega\}$。秩最小化问题就表述为&lt;/p>
&lt;p>$$
\min_{\bm{X}}\ \text{rank}(\bm{X}) \quad \text{s.t. } X_{i,j} = M_{i,j},\ \text{for every }(i,j)\in\Omega
$$&lt;/p>
&lt;p>为方便起见，定义算子 $\mathcal{P}_{\Omega}$ 如下：&lt;/p>
&lt;p>$$
[\mathcal{P}_{\Omega}(\bm{X})]_{i,j} = \begin{cases}
X_{i,j} &amp;amp; \text{if }(i,j)\in\Omega \\
0 &amp;amp; \text{otherwise}
\end{cases}
$$&lt;/p>
&lt;p>换言之，$\mathcal{P}_{\Omega}$ 将任意矩阵正交投影到以指标集 $\Omega$ 作为支撑集的所有矩阵构成的空间上。&lt;/p>
&lt;p>于是，上述问题就可以方便地写为&lt;/p>
&lt;p>$$
\min_{\bm{X}}\ \text{rank}(\bm{X}) \quad \text{s.t. } \mathcal{P}_{\Omega}(\bm{X}) = \mathcal{P}_{\Omega}(\bm{M})
$$&lt;/p>
&lt;p>问题的解就是我们对真实矩阵 $\bm{M}$ 的估计或者近似。&lt;/p>
&lt;h4 id="仿射秩最小化">仿射秩最小化&lt;/h4>
&lt;p>更一般地，我们不满足于普通的矩阵补全，而是以线性变换作为约束条件：&lt;/p>
&lt;p>$$
\min_{\bm{X}}\ \text{rank}(\bm{X}) \quad \text{s.t. } \mathcal{A}(\bm{X}) = \bm{b}
$$&lt;/p>
&lt;p>其中 $\mathcal{A}\colon\mathbb{R}^{m\times n}\to\mathbb{R}^p$ 是一个线性映射，向量 $\bm{b}\in\mathbb{R}^p$ 是给定的。这个问题被称为 &lt;em>仿射秩最小化 (affine rank minimization)&lt;/em>。&lt;/p>
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>矩阵空间上的线性变换本质上还是向量空间上的线性变换，$\mathcal{A}(\bm{X})$ 可以表述为
$$
\mathcal{A}(\bm{X}) := \begin{bmatrix}
\langle\bm{A}_1,\bm{X}\rangle_{\mathrm{F}} \\ \vdots \\ \langle\bm{A}_p,\bm{X}\rangle_{\mathrm{F}}
\end{bmatrix}
$$
其中 $\langle\bm{A},\bm{B}\rangle_{\mathrm{F}} = \text{trace}(\bm{A}'\bm{B})$ 是矩阵的 Frobenius 内积。见 &lt;a href="https://math.stackexchange.com/questions/2592633/">Stack Exchange&lt;/a>。&lt;/p>&lt;/div>
&lt;p>不难证明，$\mathcal{P}_{\Omega}$ 是一个线性变换，因而 $\mathcal{P}_{\Omega}(\bm{X}) = \mathcal{P}_{\Omega}(\bm{M})$ 构成仿射约束的一个特例。&lt;/p>
&lt;h3 id="convex-relaxation">Convex relaxation&lt;/h3>
&lt;p>遗憾的是，秩最小化问题不是一个凸优化问题，这不是我们所乐见的。原因是，秩函数（关于矩阵所有元素的函数）是非凸的。这无疑使得直接求解上述问题非常困难。我们希望找到作为替代的一个凸优化问题，它正是核范数最小化。&lt;/p>
&lt;p>那么，什么是核范数呢？我们首先得了解 &lt;em>奇异值分解 (singular value decomposition, SVD)&lt;/em>。任何一个矩阵 $\bm{X}\in\mathbb{R}^{m\times n}$，都可以作如下分解：&lt;/p>
&lt;p>$$
\underset{(m\times n)}{\bm{X}} = \underset{(m\times r)}{\bm{U}}\,\underset{(r\times r)}{\bm{\Sigma}}\,\underset{(r\times n)}{\bm{V}&amp;rsquo;}
$$&lt;/p>
&lt;p>其中 $\bm{U}$ 和 $\bm{V}$ 各自的列是正交的：$\bm{U}'\bm{U}=\bm{I}_r=\bm{V}'\bm{V}$；$\bm{\Sigma}$ 是一个对角矩阵，对角线元素是从大到小排列的 &lt;em>奇异值&lt;/em>：$\sigma_1\geq\sigma_2\geq\dots\geq\sigma_r\geq 0$，它们都是非负的；$r = \min\{m,n\}$。&lt;/p>
&lt;p>矩阵的奇异值和秩紧密相关，事实上，一个矩阵的秩等于它所有非零（因而严格正）奇异值的个数，即&lt;/p>
&lt;p>$$
\text{rank}(\bm{X}) = \sum_{i=1}^r\mathbb{1}\{\sigma_i\ne 0\}
$$&lt;/p>
&lt;p>如果我们用 $\bm{\sigma}$ 来代表所有奇异值构成的向量，那么上式就是 $\bm{\sigma}$ 的 $\ell_0$ 范数。这里离题一下，向量 $\ell_0$ 范数并不是一个真正的范数，而是 pseudo norm，因为它没有齐次性，但实际应用中仍普遍称之为「范数」，见 &lt;a href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Hamming_distance_of_a_vector_from_zero">Wiki&lt;/a>。&lt;/p>
&lt;p>现在，我们可以正式定义矩阵核范数：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:nuclear" class="thm-title thm-definition">Definition 1.&lt;/p>
&lt;div class="thm-inner thm-definition">
矩阵 $\bm{X}$ 的核范数 $\lVert\bm{X}\rVert_* := \sum_{i=1}^r \sigma_i(\bm{X})$，即所有奇异值之和。
&lt;/div>
&lt;/div>
&lt;p>可以看到，矩阵的核范数等于其奇异值向量的 $\ell_1$ 范数。核范数是一个真正的范数（要证明这一点，特别是要证明它满足三角不等式，见 &lt;a href="https://math.stackexchange.com/questions/1142540">Stack Exchange 上的回答&lt;/a>）。&lt;/p>
&lt;p>我们要做的替换就是将目标函数 $\text{rank}(\bm{X})$ 换为 $\lVert\bm{X}\rVert_*$，也就是我们考虑如下问题&lt;/p>
&lt;p>$$
\min_{\bm{X}}\ \lVert\bm{X}\rVert_* \quad \text{s.t. } \mathcal{A}(\bm{X}) = \bm{b}
$$&lt;/p>
&lt;p>这是一个凸优化问题，因为范数总是一个凸函数。核范数是秩函数的一个 &lt;em>convex relaxation&lt;/em>。&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>可以类比 Lasso 的思想，想得到一个稀疏的向量（稀疏性以 $\ell_0$ 度量），用的是 $\ell_1$ 范数。现在是矩阵，度量矩阵列向量线性独立程度的正是秩（奇异值向量的 $\ell_0$ 范数），因而用核范数作为优化目标（奇异值向量的 $\ell_1$ 范数）可以得到低秩矩阵。&lt;/p>&lt;/div>
&lt;h3 id="两种问题的等价性">两种问题的等价性&lt;/h3>
&lt;p>现在，我们如愿得到了一个凸优化问题，它比原问题更容易求解。但另一方面，这种替换是否有其正当性？换言之，最小化核范数的解是否就是最小化秩函数的解？如果不是，那显然背离了我们的初衷，我们当然希望两种问题给出的解是相同的。一般意义上，两种最小化当然不同，但在一些正则条件下可以证明它们的局部等价性，有诸多研究进行了论证。&lt;/p>
&lt;p>Recht &lt;i>et al.&lt;/i>
(2010) 证明了，在满足特定的 RIP (restricted isometry property) 条件时，仿射秩最小化问题等价于在相同约束下最小化核范数。Candès
and Recht
(2012) 则不依赖 RIP，证明了有很大的概率最小化核范数能唯一地复原矩阵，只要已知的元素个数不是太少。&lt;/p>
&lt;p>在多数矩阵补全问题中，使用核范数最小化问题作为秩最小化问题的替代是恰当的。&lt;/p>
&lt;h3 id="求解核范数最小化问题的算法">求解核范数最小化问题的算法&lt;/h3>
&lt;p>尽管核范数最小化问题是一个凸问题（但它仍是不可微分的），可以用一般性的凸优化工具求解，但求解速度可能并不十分理想。对此，有一些更迅速的方法，这里简单提及两种。&lt;/p>
&lt;p>Recht &lt;i>et al.&lt;/i>
(2010) 将核范数最小化问题转变为一个 &lt;em>半定规划 (semidefinite programming)&lt;/em>，已有成熟的软件包用于解决这类问题（通常使用 primal-dual interior-point methods）。不过，这类方法在维度很高时速度很慢。&lt;/p>
&lt;p>Cai &lt;i>et al.&lt;/i>
(2010) 使用 &lt;em>近端次梯度下降法 (proximal subgradient descent)&lt;/em> 求解，此法特别适用于不可微分的凸优化，而且对于高维情形收敛速度也可令人满意。以普通的矩阵补全为例，此文事实上是求解&lt;/p>
&lt;p>$$
\min_{\bm{X}}\ \tau\lVert\bm{X}\rVert_* + \frac12\lVert\bm{X}\rVert_{\bm{F}}^2 \quad \text{s.t. } \mathcal{P}_{\Omega}(\bm{X}) = \mathcal{P}_{\Omega}(\bm{M})
$$&lt;/p>
&lt;p>当 $\tau$ 很大时，该问题的解可以作为最小化核范数问题解的近似。求解该问题是通过一个渐进程序实现的，本质上是梯度下降，这里不做介绍。&lt;/p>
&lt;h2 id="其他">其他&lt;/h2>
&lt;p>Chandrasekaran &lt;i>et al.&lt;/i>
(2012) 是一篇很好的文章，从几何角度揭示了范数的选择问题。具体到核范数，简单来说就是核范数是秩函数的凸包 （此概念在 &lt;em>&lt;a href="../bayesian-persuasion">之前的文章&lt;/a>&lt;/em> 中出现过），因而以核范数替代秩函数是 &lt;em>最紧的凸放松 (tightest convex relaxation)&lt;/em>。&lt;/p>
&lt;p>Gu &lt;i>et al.&lt;/i>
(2014) 基于 Cai &lt;i>et al.&lt;/i>
(2010) 的求解程序，研究了 &lt;em>加权核范数最小化问题&lt;/em>，并设计了类似的求解程序。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;p>&lt;a href="https://www.zhihu.com/question/26471536">知乎问答&lt;/a>.&lt;/p>
&lt;p>Yuejie Chi (2018). &lt;em>&lt;a href="https://users.ece.cmu.edu/~yuejiec/ece18898G_notes/ece18898g_lowrank_matrix_recovery.pdf">Lecture Notes&lt;/a>.&lt;/em>&lt;/p>
&lt;p>Yuxin Chen (2020). &lt;em>&lt;a href="https://yuxinchen2020.github.io/ele520_math_data/lectures/matrix_recovery.pdf">Lecture Notes&lt;/a>.&lt;/em>&lt;/p>
&lt;div class ="box">
&lt;p>Cai, Jian-Feng &lt;em>et al.&lt;/em>
(2010).
“A Singular Value Thresholding Algorithm for Matrix Completion.”
&lt;i>SIAM Journal on Optimization&lt;/i>, 20(4), 1956–1982.
&lt;a href="https://doi.org/10.1137/080738970" title="A Singular Value Thresholding Algorithm for Matrix Completion" target="_blank" style="word-break: break-all;">doi: 10.1137/080738970&lt;/a>.&lt;/p>
&lt;p>Candès, Emmanuel and Recht, Benjamin
(2012).
“Exact matrix completion via convex optimization.”
&lt;i>Communications of the ACM&lt;/i>, 55(6), 111–119.
&lt;a href="https://doi.org/10.1145/2184319.2184343" title="Exact matrix completion via convex optimization" target="_blank" style="word-break: break-all;">doi: 10.1145/2184319.2184343&lt;/a>.&lt;/p>
&lt;p>Chandrasekaran, Venkat &lt;em>et al.&lt;/em>
(2012).
“The Convex Geometry of Linear Inverse Problems.”
&lt;i>Foundations of Computational Mathematics&lt;/i>, 12(6), 805–849.
&lt;a href="https://doi.org/10.1007/s10208-012-9135-7" title="The Convex Geometry of Linear Inverse Problems" target="_blank" style="word-break: break-all;">doi: 10.1007/s10208-012-9135-7&lt;/a>.&lt;/p>
&lt;p>Gu, Shuhang &lt;em>et al.&lt;/em>
(2014).
“Weighted Nuclear Norm Minimization with Application to Image Denoising.”
In: &lt;em>2014 IEEE Conference on Computer Vision and Pattern Recognition&lt;/em>, Columbus, OH, USA.
&lt;a href="https://doi.org/10.1109/CVPR.2014.366" title="Weighted Nuclear Norm Minimization with Application to Image Denoising" target="_blank" style="word-break: break-all;">doi: 10.1109/CVPR.2014.366&lt;/a>.&lt;/p>
&lt;p>Gu, Shuhang &lt;em>et al.&lt;/em>
(2017).
“Weighted Nuclear Norm Minimization and Its Applications to Low Level Vision.”
&lt;i>International Journal of Computer Vision&lt;/i>, 121(2), 183–208.
&lt;a href="https://doi.org/10.1007/s11263-016-0930-5" title="Weighted Nuclear Norm Minimization and Its Applications to Low Level Vision" target="_blank" style="word-break: break-all;">doi: 10.1007/s11263-016-0930-5&lt;/a>.&lt;/p>
&lt;p>Recht, Benjamin &lt;em>et al.&lt;/em>
(2010).
“Guaranteed Minimum-Rank Solutions of Linear Matrix Equations via Nuclear Norm Minimization.”
&lt;i>SIAM Review&lt;/i>, 52(3), 471–501.
&lt;a href="https://doi.org/10.1137/070697835" title="Guaranteed Minimum-Rank Solutions of Linear Matrix Equations via Nuclear Norm Minimization" target="_blank" style="word-break: break-all;">doi: 10.1137/070697835&lt;/a>.&lt;/p>
&lt;/div>
- https://gaxu.xyz/posts/nuclear-norm-min/ - 2023–2024 嘉树.</description></item><item><title>Ridge Regression</title><link>https://gaxu.xyz/posts/ridge-regression/</link><pubDate>Fri, 17 Mar 2023 13:37:45 +0800</pubDate><guid>https://gaxu.xyz/posts/ridge-regression/</guid><description>嘉树的世界 https://gaxu.xyz/posts/ridge-regression/ -&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>一周以前（3月7日）考计量期中，第一题是证明岭回归估计量的渐进分布的，我没有完整地写出来，这里面还是有些技巧，之前我并不熟悉，现在总结在这里。&lt;/p>
&lt;h2 id="岭回归简介">岭回归简介&lt;/h2>
&lt;p>Ridge regression，中文译名「岭回归」，是一种利用 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">正则化方法&lt;/a>&lt;/em> 处理 &lt;em>&lt;a href="https://en.wikipedia.org/wiki/Well-posed_problem">不适定问题&lt;/a>&lt;/em> 的技术。我们知道，使用 OLS 时是要求自变量之间不存在完全多重共线性的，即回归元矩阵必须是列满秩的，否则最小二乘问题没有唯一解；但如果某些变量间的相关性很高，甚至接近完全相关，OLS 估计量的方差将会相当大，估计精度大大下降。这个问题在待估参数很多时常常发生。岭回归通过对系数向量的 $L^2$ 范数（的平方）施加一个惩罚，控制系数的整体大小，达到以一定程度的偏误换取更低方差的目的（见 &lt;a href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff">bias-variance tradeoff&lt;/a>）。&lt;/p>
&lt;h2 id="formulation">Formulation&lt;/h2>
&lt;p>考虑线性模型：$y_i = \bm{x}_i^\prime\bm{\beta} + \varepsilon_i$，$i=1,\dots,N$。其中 $\bm{x}_i$ 和 $\bm{\beta}$ 都是 $p$ 维向量。我们更喜欢表示为矩阵形式：&lt;/p>
&lt;p>$$
\bm{Y} = \bm{X}\bm{\beta} + \bm{\mathcal{E}}
$$&lt;/p>
&lt;p>其中 $\bm{Y} = (y_1,\dots,y_N)^\prime$，$\bm{X} = (\bm{x}_1,\dots,\bm{x}_N)^\prime$，$\bm{\mathcal{E}} = (\varepsilon_1,\dots,\varepsilon_N)^\prime$。假设 $\mathbb{E}(\varepsilon_i|\bm{x}_i) = 0$ 以及 $\mathbb{E}(\varepsilon_i^2|\bm{x}_i) = \sigma^2$，并假设 $\{(\bm{x}_i,y_i)\}_{i=1}^n$ 是独立同分布的。&lt;/p>
&lt;p>岭回归估计量 $\hat{\bm{\beta}}$ 来自如下带有惩罚项的最小二乘问题：&lt;/p>
&lt;p>$$
\min_{\bm{\beta}}\quad \frac1n(\bm{Y}-\bm{X}\bm{\beta})^\prime(\bm{Y}-\bm{X}\bm{\beta}) + \lambda\bm{\beta}^\prime\bm{\beta}
\tag{$*$}
$$&lt;/p>
&lt;p>这里 $\lambda$ 是一个参数，它衡量了惩罚的大小。当 $\lambda=0$ 时，该问题就是 OLS；当 $\lambda\to\infty$ 时，$\bm{\beta} = \bm{0}$。事实上，这个问题等价于一个有约束的最小二乘：&lt;/p>
&lt;p>$$
\min_{\bm{\beta}}\quad (\bm{Y}-\bm{X}\bm{\beta})^\prime(\bm{Y}-\bm{X}\bm{\beta}) \qquad \text{s.t.}\quad \bm{\beta}^\prime\bm{\beta} = c^2
$$&lt;/p>
&lt;p>其中 $c$ 为某个非负常数。可见我们是在 $p$ 维 Euclidean 空间中半径为 $c$ 的球面上寻找最小二乘估计量。&lt;/p>
&lt;p>由 $(*)$，一阶条件为 $n^{-1}(-2\bm{X}^\prime\bm{Y}+2\bm{X}^\prime\bm{X}\bm{\beta})+2\lambda\bm{\beta} = \bm{0}$，于是岭回归估计量&lt;/p>
&lt;p>$$
\hat{\bm{\beta}} = \left(\frac1n\bm{X}^\prime\bm{X}+\lambda\bm{I}_p\right)^{-1}\frac1n\bm{X}^\prime\bm{Y}
$$&lt;/p>
&lt;p>其中 $\bm{I}_p$ 是 $p$ 阶单位阵。&lt;/p>
&lt;h2 id="渐进分布">渐进分布&lt;/h2>
&lt;p>我们把 $\bm{Y} = \bm{X}\bm{\beta} + \bm{\mathcal{E}}$ 带入 $\hat{\bm{\beta}}$ 的表达式，并做适当整理变形，得到&lt;/p>
&lt;p>$$
\hat{\bm{\beta}} - \bm{\beta} = \left(\frac1n\bm{X}^\prime\bm{X}+\lambda\bm{I}_p\right)^{-1}\frac1n\bm{X}^\prime\bm{\mathcal{E}} - \left(\frac1n\bm{X}^\prime\bm{X}+\lambda\bm{I}_p\right)^{-1}\lambda\bm{\beta}
$$&lt;/p>
&lt;p>为简化符号，记 $\bm{B}_i = \bm{x}_i\bm{x}_i^\prime+\lambda\bm{I}_p$，$\bar{\bm{B}}_n = n^{-1}\sum_{i=1}^n\bm{B}_i$，其无条件期望 $\mathbb{E}(\bm{x}_i\bm{x}_i^\prime)+\lambda\bm{I}_p$ 记作 $\bm{B}$；此外，记 $\bm{Q} = \mathbb{E}(\bm{x}_i\bm{x}_i^\prime)$。&lt;/p>
&lt;p>为应用中心极限定理（CLT），需要将上式整理成某个样本均值的形式。事实上，我们应当考虑构造一个更大的随机向量，导出其渐进分布，然后应用 &lt;a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93Wold_theorem">Cramér–Wold device&lt;/a> 得到估计量的渐进分布。如果我们构造 $(\bm{x}_i^\prime\varepsilon_i,\lambda\bm{\beta}^\prime)^\prime$，则无法直接应用 CLT，因为该向量均值非零（除非 $\bm{\beta} = \bm{0}$）。正确的方式是作如下变形：&lt;/p>
&lt;p>$$
\begin{aligned}
\hat{\bm{\beta}} - \bm{\beta} + \lambda\bm{B}^{-1}\bm{\beta} &amp;amp;= \bar{\bm{B}}_n^{-1}\left[\frac1n\bm{X}^\prime\bm{\mathcal{E}}-(\bm{I}_p-\bar{\bm{B}}_n\bm{B}^{-1})\lambda\bm{\beta}\right] \\
&amp;amp;= \bar{\bm{B}}_n^{-1}\frac1n\sum_{i=1}^n\Bigl[\bm{x}_i\varepsilon_i-(\bm{I}_p-\bm{B}_i\bm{B}^{-1})\lambda\bm{\beta}\Bigr]
\end{aligned}
$$&lt;/p>
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>我们可以将 summand 视为一体，计算其均值和方差，然后直接应用 CLT，这本质上和 Cramér–Wold device 相同。&lt;/p>&lt;/div>
&lt;p>考虑随机向量 $(\bm{c}_i^\prime,\bm{e}_i^\prime)^\prime$，其中 $\bm{c}_i = \bm{x}_i\varepsilon_i$，$\bm{e}_i = (\bm{I}_p-\bm{B}_i\bm{B}^{-1})\lambda\bm{\beta}$。易见 $\{(\bm{c}_i^\prime,\bm{e}_i^\prime)^\prime\}_{i=1}^n$ 是独立同分布的，均值为 $\bm{0}$，协方差矩阵&lt;/p>
&lt;p>$$
\bm{V} = \begin{pmatrix}
\sigma^2\bm{Q} &amp;amp; \bm{0} \\
\bm{0} &amp;amp; \lambda^2\bm{D}
\end{pmatrix}
$$&lt;/p>
&lt;p>其中 $\bm{D} = \mathbb{E}(\bm{B}_i\bm{B}^{-1}\bm{\beta\beta}^\prime\bm{B}^{-1}\bm{B}_i)-\bm{\beta}\bm{\beta}^\prime$。由 CLT，有&lt;/p>
&lt;p>$$
\frac1{\sqrt{n}}\sum_{i=1}^n\begin{pmatrix}
\bm{c}_i \\ \bm{e}_i
\end{pmatrix} \to_d N(\bm{0},\bm{V})
$$&lt;/p>
&lt;p>于是，利用 Cramér–Wold device，有&lt;/p>
&lt;p>$$
\begin{aligned}
\frac1{\sqrt{n}}\sum_{i=1}^n\Bigl[\bm{x}_i\varepsilon_i-(\bm{I}_p-\bm{B}_i\bm{B}^{-1})\lambda\bm{\beta}\Bigr] &amp;amp;= (1,-1)\frac1{\sqrt{n}}\sum_{i=1}^n\begin{pmatrix}
\bm{c}_i \\ \bm{e}_i
\end{pmatrix} \begin{pmatrix}
1 \\ -1
\end{pmatrix}
\\
&amp;amp;\to_d N(\bm{0}, \sigma^2\bm{Q}+\lambda^2\bm{D})
\end{aligned}
$$&lt;/p>
&lt;p>最后，$\bar{\bm{B}}_n\to_p\bm{B}$，根据 Slutsky 定理，有&lt;/p>
&lt;p>$$
\sqrt{n}(\hat{\bm{\beta}} - \bm{\beta} + \lambda\bm{B}^{-1}\bm{\beta}) \to_d N(\bm{0},\bm{\Omega})
$$&lt;/p>
&lt;p>其中 $\bm{\Omega} = \bm{B}^{-1}(\sigma^2\bm{Q}+\lambda^2\bm{D})\bm{B}^{-1}$。&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>值得一提，Knight and Fu (2000) 也给出了岭回归估计量的渐进分布，但其做法根本上是不同的，且不适用于我们这里的情形。由于他们并未在 $(*)$ 中第一项前添加 $1/n$，所以按照其文中定义，$\lambda_n = n\lambda$ 并非 $O(\sqrt{n})$，故其 Theorem 2 不能适用。&lt;/p>&lt;/div>
&lt;h2 id="延伸思考">延伸思考&lt;/h2>
&lt;p>如果我们想构造渐进方差 $\bm{\Omega}$ 的一致估计，则需要构造 $\bm{B},\bm{Q},\bm{D}$ 的一致估计，前两者容易，而 $\bm{D}$ 较为困难。&lt;/p>
&lt;ul>
&lt;li>记 $\bm{A} = \bm{B}^{-1}\bm{\beta\beta}^\prime\bm{B}^{-1}$。&lt;/li>
&lt;li>$\bm{\beta}$ 的一致估计 $\bar{\bm{\beta}} = (\bm{I}_p - \lambda\bar{\bm{B}}_n^{-1})^{-1}\hat{\bm{\beta}}$。&lt;/li>
&lt;li>$\bm{A}$ 的一致估计 $\bar{\bm{A}} = \bar{\bm{B}}_n^{-1}\bar{\bm{\beta}}\bar{\bm{\beta}}^\prime\bar{\bm{B}}_n^{-1}$。&lt;/li>
&lt;/ul>
&lt;p>乍一看，似乎不能用 $n^{-1}\sum_i\bm{B}_i\bar{\bm{A}}\bm{B}_i$ 作为 $\mathbb{E}(\bm{B}_i\bm{A}\bm{B}_i)$ 的一致估计，因为 $\bar{\bm{A}}$ 本身就是一个估计量，$\bm{B}_i\bar{\bm{A}}\bm{B}_i$ 将不是一列独立随机矩阵，也就无法引用大数定律得到一致性。但实际上是可行的，只需利用 trace 的性质对每个 entry 进行分析：&lt;/p>
&lt;ul>
&lt;li>$\bm{B}_i\bar{\bm{A}}\bm{B}_i$ 的第 $(k,\ell)$ 元素是 $\bm{b}_{ik}^\prime\bar{\bm{A}}\bm{b}_{i\ell}$，$\bm{b}_{ik}^{\prime}$ 是 $\bm{B}_i$ 的第 $k$ 行，注意 $\bm{B}_i$ 是对称矩阵。&lt;/li>
&lt;li>$\frac1n\sum_i\text{tr}(\bm{b}_{ik}^\prime\bar{\bm{A}}\bm{b}_{i\ell}) = \text{tr}(\frac1n\sum_i\bm{b}_{i\ell}\bm{b}_{ik}^\prime\bar{\bm{A}})$ 依概率收敛到 $\mathbb{E}(\bm{B}_i\bm{A}\bm{B}_i)$ 的第 $(k,\ell)$ 元素，也就是 $\mathbb{E}(\bm{b}_{ik}^\prime\bm{A}\bm{b}_{i\ell}) = \text{tr}(\mathbb{E}[\bm{b}_{i\ell}\bm{b}_{ik}^\prime]\bm{A})$。&lt;/li>
&lt;/ul>
&lt;p>这和 OLS 中异方差时对渐进方差的估计有些相似，比如都是三明治形式。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ol>
&lt;li>&amp;ldquo;&lt;a href="https://en.wikipedia.org/wiki/Ridge_regression">Ridge regression&lt;/a>.&amp;rdquo; &lt;em>Wikipedia&lt;/em>, accessed March 17, 2023.&lt;/li>
&lt;li>van Wieringen, W. N. &amp;ldquo;Lecture Notes on Ridge Regression.&amp;rdquo; &lt;em>arXiv preprint&lt;/em>, submitted in 2015. &lt;a href="https://arxiv.org/pdf/1509.09169.pdf">arXiv:1509.09169&lt;/a>.&lt;/li>
&lt;li>Knight, Keith and Wenjiang Fu. 2000. &amp;ldquo;Asymptotics for Lasso-type Estimators.&amp;rdquo; &lt;em>The Annals of Statistics&lt;/em>, 28 (5): 1356-1378.&lt;/li>
&lt;li>Hansen, Bruce. 2022. &lt;em>Econometrics&lt;/em>. Princeton University Press.&lt;/li>
&lt;/ol>
- https://gaxu.xyz/posts/ridge-regression/ - 2023–2024 嘉树.</description></item><item><title>Bayesian Persuasion</title><link>https://gaxu.xyz/posts/bayesian-persuasion/</link><pubDate>Wed, 08 Mar 2023 22:25:46 +0800</pubDate><guid>https://gaxu.xyz/posts/bayesian-persuasion/</guid><description>嘉树的世界 https://gaxu.xyz/posts/bayesian-persuasion/ -&lt;h2 id="内容提要">内容提要&lt;/h2>
&lt;p>本文是基于 Kamenica and Gentzkow (2011) 的学习笔记，仅对微观课上覆盖的内容做了分析，目的只是通过考试，并不是对文章的全面剖析，但由于上课时一头雾水，为了彻底理解均衡的概念，有必要深入学习。以下分为两节，第一节直接介绍模型框架和重要推论，第二节给出解题的一般方法，此方法是几何直观的，依赖于第一节的分析。&lt;/p>
&lt;p>相比于普通的信号博弈，Bayesian persuasion 中的信号发送者表现得既像 informed，又像 uninformed。其 informed 的地方在于，发送者所发送的信号是条件于 state 的；其 uninformed 的地方在于，发送者最大化事前的期望效用（无条件期望）。此外，信号结构并非是给定的，而全由发送者决定，即内生化了。&lt;/p>
&lt;p>如前所示，由于信号发送者全权决定信号结构，他可以将信号设计得非常复杂，为简化分析，我们作出一个重要假设：发送者必须如实地告知接收者信号的实现结果。这基本上是在假设信号只有一层。&lt;/p>
&lt;h2 id="一般模型框架">一般模型框架&lt;/h2>
&lt;blockquote>
&lt;p>信号发送者（简称「发送者」）所发送的具体内容是什么并不重要，重要的是，其发送的信号是一个（条件）分布，条件于 state，state 不同则分布不同，这种分布上的差异传递出了关于 state 的信息，迫使一个（贝叶斯式的）信号接收者（简称「接收者」）更新自己的信念，反而采取有利于发送者的行动。&lt;/p>
&lt;/blockquote>
&lt;h3 id="模型设定">模型设定&lt;/h3>
&lt;p>基本的模型设定如下：&lt;/p>
&lt;ul>
&lt;li>State space $\Omega$ 是一个有限集；&lt;/li>
&lt;li>接收者的 action space $A$ 是一个紧集；&lt;/li>
&lt;li>发送者有定义在 $A\times\Omega$ 上的（关于 $a$）连续效用函数 $v(a,\omega)$；&lt;/li>
&lt;li>接收者有定义在 $A\times\Omega$ 上的（关于 $a$）连续效用函数 $u(a,\omega)$；&lt;/li>
&lt;li>发送者和接收者具有共同的关于 state 的先验信念 $\mu_0$，它是 $\Omega$ 上的概率测度，且严格为正（为了应用 Bayes 法则）；&lt;/li>
&lt;li>一个信号 $\pi$ 是条件于 $\omega$ 的概率测度的集合：$\{\pi(\cdot|\omega)\}_{\omega\in\Omega}$，每个概率测度都定义在同一 realization space $S$ 上，$S$ 由发送者内生决定。&lt;/li>
&lt;/ul>
&lt;p>以概率论的视角来看，由于我们引入了条件概率 $\pi(s|\omega)$，$(\omega,s)$ 将有 $\Omega\times S$ 上的联合分布。&lt;/p>
&lt;h3 id="timing">Timing&lt;/h3>
&lt;p>博弈的 timing 如下：&lt;/p>
&lt;ol>
&lt;li>Nature 从分布 $\mu_0$ 中选择一个 state；&lt;/li>
&lt;li>发送者选择一个信号；&lt;/li>
&lt;li>接收者观察到信号结构和信号的 realization，选择一个行动。&lt;/li>
&lt;/ol>
&lt;p>整个 timing 和普通的信号模型本质上并无不同，本质上不同的还是信号结构的内生以及发送者 informed 的程度。&lt;/p>
&lt;h3 id="均衡的定义">均衡的定义&lt;/h3>
&lt;p>称 $(\pi,\hat{a}(\mu_s))$ 为一个&lt;strong>有利于发送者的子博弈完美均衡&lt;/strong>（sender-preferred subgame perfect equilibrium）若&lt;/p>
&lt;ol>
&lt;li>给定 $\pi$ 和每一个 realization $s$，接收者按照 Bayes 法则形成后验 $\mu(\omega|s)$，简记为 $\mu_s$，$\hat{a}(\mu_s)$ 最大化了接收者的后验期望效用：&lt;/li>
&lt;/ol>
&lt;p>$$\hat{a}(\mu_s)\in\arg\max_{a\in A}\mathbb{E}_{\mu_s}[u(a,\omega)]$$&lt;/p>
&lt;ol start="2">
&lt;li>给定 $\hat{a}(\mu_s)$，$\pi$ 最大化了发送者事前期望效用（无条件期望）$\mathbb{E}[v(\hat{a}(\mu_s),\omega)]$。&lt;/li>
&lt;/ol>
&lt;style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.night .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:0 18px 18px;line-height:24px;margin-bottom:20px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:var(--title-color)}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}&lt;/style>
&lt;div>&lt;svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg">&lt;symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/>&lt;/symbol>&lt;symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/>&lt;/symbol>&lt;symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet">&lt;path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/>&lt;/symbol>&lt;/svg>&lt;/div>&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>这里最重要的设定是发送者最大化&lt;strong>事前&lt;/strong>无条件期望，而不是像一般的发信号模型那样，每个 type 的发送者分别最大化自己的期望效用（即条件于 type）。但信号又条件于 state，此意义上讲，发送者似有多个信息集。这也是为什么我在本文开头说，此模型中的信号发送者表现得既像 informed，又像 uninformed。对此，我的解释是，发送者所设计的信号是 state-contingent，当 state 实现，这个信号就会坍缩为相应的子信号，也就是条件于 state 的一个分布。&lt;/p>&lt;/div>
&lt;p>为方便起见，定义信号的&lt;strong>价值&lt;/strong>为上述无条件期望。定义信号的&lt;strong>增益&lt;/strong>为其价值和当接收者没有获得任何信息情况下 $v(a,\omega)$ 的期望（即 $\mathbb{E}[v(\hat{a}(\mu_0),\omega)]$）之间的差值（简单来说就是一个信号相比无信息信号能带来多大的期望效用增益）。如果增益严格为正，那么我们说接收者从 persuation 中获益（benefits from persuasion）。最优信号指的是实现了最大增益的信号。显然，在均衡中发送者会选择最优信号。&lt;/p>
&lt;p>无条件期望可以根据迭代期望法则写为：$\mathbb{E}[\mathbb{E}[v(\hat{a}(\mu_s),\omega)|\omega]]$，其中内层的条件期望即是在 $\pi(s|\omega)$ 下取得，外层的期望则是在 $\mu_0(\omega)$ 下取得。直接求解最优的条件分布无疑是很困难的，主要有两个原因：第一，realization space 的选择是内生的而非给定的；第二，即便我们能缩小 realization space 的选择范围，也很难有一种直观上的方式求解 $\pi$。如果我们能转换思路，先求最优后验信念 $\mu(\omega|s)$，再恢复 $\pi$，事情将好办很多。这就是下一小节的内容。&lt;/p>
&lt;h3 id="对发送者最优化问题的变换">对发送者最优化问题的变换&lt;/h3>
&lt;blockquote>
&lt;p>&lt;em>We can reexpress the problem of choosing an optimal signal as a search over distributions of posteriors subject to the constraint that the expected posterior is equal to the prior.&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>简单来说，我们先条件于 $s$ 而不是 $\omega$，即&lt;/p>
&lt;p>$$
\mathbb{E}[v(\hat{a}(\mu_s),\omega)] = \mathbb{E}[\mathbb{E}[v(\hat{a}(\mu_s),\omega)|s]]
$$&lt;/p>
&lt;p>内层的条件期望在后验信念 $\mu(\omega|s)$ 下取得。发送者寻找最优信号 $\pi(s|\omega)$ 的目标等价于寻找最优后验信念 $\mu(\omega|s)$ 和 $s$ 的无条件分布 $\tau(s)$，随后可由 Bayes 法则恢复信号：&lt;/p>
&lt;p>$$
\pi(s|\omega) = \mu(\omega|s)\tau(s)/\mu_0(\omega)
$$&lt;/p>
&lt;p>这也必定保证了接收者按照 Bayes 法则更新自己的信念。当然，为保证概率和为 1，即 $\sum_s\pi(s|\omega) = 1$，我们要求 $\mu(\omega|s)$ 和 $\tau(s)$ 满足 $\int_s \mu(\omega|s)\thinspace d\tau(s) = \mu_0(\omega)$，这在文中被称为 &lt;em>&lt;strong>Bayes plausibility&lt;/strong>&lt;/em>。&lt;/p>
&lt;p>不过，我们希望更进一步地简化问题，可能有一些 $s$，它们会导致相同的后验信念，这将意味着条件期望 $\mathbb{E}[v(\hat{a}(\mu_s),\omega)|s]$ 在这些 $s$ 间也是相同的，我们可以将这些 $s$ 视为同一类。这样，不同类可由它们导致的后验 $\mu$ 进行区分，从而得到 $\mu$ 的一个集合，我们再在此上定义概率空间。于是 $(\omega,s)$ 联合分布变成 $(\omega,\mu)$ 联合分布。我们仍用 $\tau$ 表示 $\mu$ 的无条件分布（或边缘分布）。具体而言，我们有&lt;/p>
&lt;p>$$\tau(\mu)=\sum_{\{s\colon\mu_s=\mu\}}\tau(s)=\sum_{\{s\colon\mu_s=\mu\}}\sum_{\omega}\pi(s|\omega)\mu_0(\omega)$$&lt;/p>
&lt;p>当然，如果 $\mu_s$ 和 $s$ 一一对应的话，我们只是换了一下记号而已。&lt;/p>
&lt;p>这种整合并未改变无条件期望，即&lt;/p>
&lt;p>$$
\mathbb{E}[v(\hat{a}(\mu),\omega)] = \mathbb{E}[\mathbb{E}[v(\hat{a}(\mu),\omega)|\mu]] = \mathbb{E}_\tau[\mathbb{E}_\mu[v(\hat{a}(\mu),\omega)]]
$$&lt;/p>
&lt;p>我们将内层的条件期望记作 $\hat{v}(\mu)$，因此上述无条件期望就是 $\mathbb{E}_{\tau}\hat{v}(\mu)$。Bayes plausibility 要求 $\int_{\mu}\mu\thinspace d\tau(\mu) = \mu_0$。&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>以上的变换本质上是在压缩 realization space，似乎不是很有必要。我们可以假设每个 state 引致的后验都是不同的，即假设 $\mu_s$ 和 $s$ 一一对应。&lt;/p>&lt;/div>
&lt;p>以上的分析已经足够我们理解本文的核心论断，即下一小节的 &lt;a href='#thm%3abestsig'>推论&lt;/a>，只是为了严谨，尚需处理一些细节问题。&lt;/p>
&lt;h3 id="技术补充">技术补充$^*$&lt;/h3>
&lt;p>现在有两个问题，第一，发送者可以选择十分复杂的信号结构，换言之，信号的 realization space 可能大于接收者的 action space。这种情况实际上可以得到简化，我们最终只需考虑和 action space 形成一一对应的 realization space。我们将 realization space 的势不大于 action space 的势的那些信号称为&lt;strong>简单信号&lt;/strong>（straightforward signal&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>）。第二个问题是，给定满足 Bayes plausibility 的 $\mu$ 和 $\tau$，其背后是否一定有 well-defined 之信号 $\pi$？尽管 Bayes 法则能用于离散和连续情况，但我们希望对于一般的情况进行证明。&lt;/p>
&lt;p>我们可以证明如下命题：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:equiv" class="thm-title thm-proposition">Proposition 1.&lt;/p>
&lt;div class="thm-inner thm-proposition">
&lt;p>以下表述等价：&lt;/p>
&lt;ol>
&lt;li>存在某个信号，其价值为 $v^*$；&lt;/li>
&lt;li>存在简单信号，其价值为 $v^*$;&lt;/li>
&lt;li>存在 Bayes-plausible 分布 $\tau$，使得 $\mathbb{E}_{\tau}\hat{v}(\mu) = v^*$。&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-1" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
&lt;p>根据定义，易知命题 2 可导出命题 1 和 3。现在证明命题 1 可导出命题 2。对于一个信号 $\pi$，假设其价值为 $v^*$，令 $S^a = \{s\colon\hat{a}(\mu_s)=a\}$，也就是说，我们把使得接收者的最优行动为 $a$ 的信号 realization 都收集起来构成一个集合。我们可以据此构造一个新的信号：其 realization space 和接收者的 action space一一对应，即 $S^\prime \leftrightarrow A$，定义 $\pi^\prime(\alpha|\omega) = \sum_{s\in S^a}\pi(s|\omega)$。简单来说，我们对原来的 realization space 按照其引致的 action 做了一个分割，然后将每个子集上的概率加总得到一个新的概率，新的 realization space 则和 action space 构成一一映射（$\alpha$ 和 $a$）。因为 $a$ 对每个 $s\in S^a$ 都是接收者的最优行动，对于 $\alpha\in S^\prime$，$a$ 也必定是最优行动。如果要严格证明这一点，只需注意到 $\mu(\omega|\alpha) \propto \pi(\alpha|\omega)\mu_0(\omega) = \sum_{s\in S^a}\pi(s|\omega)\mu_0(\omega)$，而 $\mathbb{E}_{\mu_s}[u(a,\omega)] \propto \sum_{\omega\in\Omega}\pi(s|\omega)\mu_0(\omega)u(a,\omega)$。这种构造意味着，条件于 $\omega$，最优行动在 $\pi^\prime$ 下的分布和在 $\pi$ 下的分布相同；具体而言，在 $\pi^\prime$ 下，最优行动取 $a$ 的条件概率为 $\pi(\alpha|\omega)$，在 $\pi$ 下，取 $a$ 的条件概率为 $\sum_{s\in S^a}\pi(s|\omega) = \pi(\alpha|\omega)$。这意味着 $\mathbb{E}[v(\hat{a}_s,\omega)|\omega] = \mathbb{E}[v(\hat{a}_\alpha,\omega)|\omega]$，从而其无条件期望相等，也就是两种信号的价值都为 $v^*$。&lt;/p>
&lt;p>现在证明命题 3 可导出命题 1。注意，我们不能直接根据 $\tau$ 来构造信号，因为 $\tau$ 的支撑集可能是无限集，从而构造的信号为零概率（似乎可以将 $\tau$ 视为概率密度来构造信号的密度，不过这并不能涵盖任意分布）。由于 $\Omega$ 是有限集（假设有 $d$ 个元素），这意味着 $\hat{v}(\mu)$ 可视作 $(\mu_s(\omega_1),\dots,\mu_s(\omega_{d-1}))$ 的函数。于是，我们得到了 $\mathbb{R}^d$ 空间内的一系列点：$(\mu_s(\omega_1),\dots,\mu_s(\omega_{d-1}),\hat{v})\in\mathbb{R}^d$。这样一来，$\mathbb{E}_{\tau}\hat{v}(\mu) = v^*$ 也是 $\mathbb{R}^d$ 空间内的一点：$(\mu_0(\omega_1),\dots,\mu_0(\omega_{d-1}),v^*)$，更重要的是，它位于前述那些点构成的 &lt;a href="https://en.wikipedia.org/wiki/Convex_hull">凸包络集（或凸包）&lt;/a> 之内。因此，应用 &lt;a href="https://en.wikipedia.org/wiki/Carath%C3%A9odory%27s_theorem_%28convex_hull%29">Carathéodory 定理&lt;/a>，它一定可以表述为该凸包络集内&lt;strong>有限&lt;/strong>个点的凸组合，换言之，存在一个支撑集为&lt;strong>有限&lt;/strong>集的 Bayes-plausible 分布 $\tau^*$，使得 $\mathbb{E}_{\tau^*}\hat{v}(\mu) = v^*$。据此，我们可以定义信号的 realization space 为 $\{s\colon\mu_s\in\text{Supp}(\tau^*)\}$，进而定义信号 $\pi(s|\omega) = \mu(\omega|s)\tau^*(\mu_s)/\mu_0(\omega)$，这个信号将引致 $\tau^*$，从而具有价值 $v^*$。&lt;/p>
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-1">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>从以上定理我们可以绕过对最优信号的直接求解，而是先求 $\tau$ 和相应的支撑集，再按照 Bayes 法则恢复出 $\pi$，这已经被证明一定可以做到。我们立即有如下推论：&lt;/p>
&lt;div class="thm">
&lt;p id="thm:bestsig" class="thm-title thm-corollary">Corollary 2.&lt;/p>
&lt;div class="thm-inner thm-corollary">
&lt;p>发送者可以从 persuation 中获益当且仅当存在一个 Bayes-plausible 分布 $\tau$ 使得&lt;/p>
&lt;p>$$\mathbb{E}_{\tau}\hat{v}(\mu) &amp;gt; \hat{v}(\mu_0)$$&lt;/p>
&lt;p>此外，最优信号的价值就是&lt;/p>
&lt;p>$$\max_{\tau}\ \mathbb{E}_{\tau}\hat{v}(\mu) \quad \text{s.t.}\int\mu\thinspace d\tau(\mu) = \mu_0$$&lt;/p>
&lt;/div>
&lt;/div>
&lt;div class="thm">
&lt;button type="button" class="collapsible">&lt;div id="thm-proof-2" class="thm-title-proof">Proof.&lt;/div>&lt;/button>
&lt;div class="proof-content">
&lt;div class="thm-inner-proof">
显然，略。
&lt;/div>
&lt;div class="thm-end-proof">
&lt;i class="fas fa-square">&lt;/i> &lt;a href="#thm-proof-2">&lt;i class="fas fa-arrow-circle-up">&lt;/i>&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>值得一提，根据 &lt;a href='#thm%3aequiv'>命题 1&lt;/a>，我们只需关注 realization space 和 action space 等势的情况。&lt;/p>
&lt;h2 id="一般问题中的求解方式">一般问题中的求解方式&lt;/h2>
&lt;p>在一般问题中，我们如何求解最优信号及其价值呢？事实上，&lt;a href='#thm%3abestsig'>上述推论&lt;/a> 意味着我们可以有一种几何上非常直观的方式。&lt;/p>
&lt;p>假设 action space 有两个元素，那么我们只用考虑 realization space 有两个元素的情况（假设 $s_1$ 和 $s_2$）。因此，$\pi$ 和 $\tau$ 都是二项分布（再次回忆，$\pi$ 是 $s$ 的条件分布，而 $\tau$ 实质上是 $s$ 的无条件分布）。此外，假设 state space 也只有两个元素，这样，我们就可以用一个维度代表后验，例如，$\mu(\omega_1|s)$，不妨简记为 $\mu_s$。按照 &lt;a href='#thm%3abestsig'>推论&lt;/a>，信号 $\pi$ 的价值就是在 $\mu$-$\hat{v}(\mu)$ 图像上的 $(\mu_{s_1},\hat{v}(\mu_{s_1}))$ 和 $(\mu_{s_2},\hat{v}(\mu_{s_2}))$ 两点和直线 $\mu=\mu_0$ 交点的纵坐标；交点就是这两点的加权中点，权重就是 $\tau$。需要注意，当两点连线和 $\mu=\mu_0$ 无交点时，说明以这两点为支撑集的任何 $\tau$ 都不是 Bayes-plausible，也就无法实现增益；当然，给定先验，我们总能找到 Bayes-plausible 分布（在 $\mu=\mu_0$ 两边取点即可）。见下图中 Panel B。&lt;/p>
&lt;figure id = "fig:conc" align="" role="group" aria-describedby="caption-1d1df851cd07aac8d754ff14a72c4cf1">
&lt;a href="https://gaxu.xyz/posts/bayesian-persuasion/images/concave-closure.png" class="img-link">
&lt;img src="https://gaxu.xyz/posts/bayesian-persuasion/images/concave-closure.png" style="width: 80%;">
&lt;/a>
&lt;figcaption id="caption-1d1df851cd07aac8d754ff14a72c4cf1">
Concave Closure (Source: Kamenica and Gentzkow, 2011, Fig.2)
&lt;/figcaption>
&lt;/figure>
&lt;p>易知两点连线总是在 $\hat{v}(\mu)$ 图像的凸包之内，因此我们取凸包的边界函数，称为 $\hat{v}$ 的&lt;strong>凹闭包&lt;/strong>（concave closure）：&lt;/p>
&lt;p>$$V(\mu) \equiv \sup\{y\colon (\mu,y)\in\text{conv}(\hat{v})\}$$&lt;/p>
&lt;p>这里 $\text{conv}(\hat{v})$ 表示 $\hat{v}$ 图像的凸包络集。$V(\mu)$ 必定是凹函数（因而称为凹闭包），并且是处处大于等于 $\hat{v}$ 的最小凹函数；它衡量了，当 state 的先验为 $\mu$ 时，发送者所能实现的最大价值，如 &lt;a href='#fig%3aconc'>上图&lt;/a> Panel C 所示。&lt;/p>
&lt;div class="notice note" >
&lt;p class="first notice-title">&lt;span class="icon-notice baseline">&lt;svg>&lt;use href="#note-notice">&lt;/use>&lt;/svg>&lt;/span>Note&lt;/p>&lt;p>即便 action space 是无限集，我们也许只需要两个 realization，前提是它们与 $\mu = \mu_0$ 的交点位于 $V(\mu)$ 图像上。&lt;/p>&lt;/div>
&lt;h3 id="一个例子">一个例子&lt;/h3>
&lt;p>现在用一个简单例子阐述求解过程。假设在一例案件中，检方（发送者）想要说服法官（接收者）对被告作出有罪判决，具体设定如下：&lt;/p>
&lt;ul>
&lt;li>有两种状态：被告是 &lt;em>guilty&lt;/em> 或者 &lt;em>innocent&lt;/em>，先验信念 $\mu_0(\textit{guilty}) = 0.3$；&lt;/li>
&lt;li>法官（接收者）有两种行动：&lt;em>acquit&lt;/em> 或 &lt;em>convict&lt;/em>；&lt;/li>
&lt;li>法官若作出正确判决，则法官效用为 1，否则为 0；&lt;/li>
&lt;li>法官若 &lt;em>convict&lt;/em>，则检方效用为 1，否则为 0。&lt;/li>
&lt;/ul>
&lt;p>试问，法官应该如何设定信号以最大化自己的效用？&lt;/p>
&lt;p>首先，我们求法官的最优行动 $\hat{a}(\mu)$，这里 $\mu$ 表示关于被告是 &lt;em>guilty&lt;/em> 的信念。显然，当 $\mu &amp;lt; 0.5$ 时，法官最优行动是 &lt;em>acquit&lt;/em>，当 $\mu \geq 0.5$ 时是 &lt;em>convict&lt;/em>。因此，检方的后验效用就是：当 $\mu &amp;lt; 0.5$，$\hat{v}(\mu) = 0$；当 $\mu \geq 0.5$，$\hat{v}(\mu) = 1$，如 &lt;a href='#fig%3aconc'>上图&lt;/a> 所示。我们可以在其凹闭包上找到对应于先验 $\mu_0 = 0.3$ 的最大信号价值 $V(0.3) = 0.6$。$\tau$ 的支撑集显然是 $\{\mu_{s_1} = 0,\mu_{s_2}=0.5\}$。 随后根据 Bayes plausibility 确定 $\tau$：&lt;/p>
&lt;p>$$0\cdot\tau(s_1)+0.5\cdot\tau(s_2)=0.3 \Rightarrow \tau(s_1)=0.4,\tau(s_2)=0.6$$&lt;/p>
&lt;p>最后，恢复最优信号：&lt;/p>
&lt;p>$$
\begin{aligned}
&amp;amp;\pi(s_1|\textit{guilty})=\mu(\textit{guilty}\thinspace|s_1)\tau(s_1)/\mu_0(\textit{guilty}) = 0 \\
&amp;amp;\pi(s_1|\textit{innocent})=\mu(\textit{innocent}\thinspace|s_1)\tau(s_1)/\mu_0(\textit{innocent}) = 4/7
\end{aligned}
$$&lt;/p>
&lt;p>简单来说，分三步走：第一，确定 $\tau$ 的支撑集；第二，利用 Bayes plausibility 确定 $\tau$；第三，根据 Bayes 法则恢复最优信号。&lt;/p>
&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>Kamenica, Emir, and Matthew Gentzkow. 2011. &amp;ldquo;Bayesian Persuasion.&amp;rdquo; &lt;em>American Economic Review&lt;/em>, 101 (6): 2590-2615.&lt;/li>
&lt;/ul>
&lt;br>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>原文定义 $S\subseteq A$ 的那些信号为简单信号，这里采用更具一般性的定义。&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
- https://gaxu.xyz/posts/bayesian-persuasion/ - 2023–2024 嘉树.</description></item></channel></rss>